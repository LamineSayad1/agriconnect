[
    {
        "filePath": "E:\\agri\\.expo\\types\\router.d.ts",
        "messages": [],
        "suppressedMessages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'T' is defined but never used.",
                "line": 8,
                "column": 31,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 8,
                "endColumn": 32,
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\(tabs)\\_layout.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\(tabs)\\index.tsx",
        "messages": [],
        "suppressedMessages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'checkUser'. Either include it or remove the dependency array.",
                "line": 17,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 17,
                "endColumn": 10,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [checkUser]",
                        "fix": {
                            "range": [
                                701,
                                703
                            ],
                            "text": "[checkUser]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\(tabs)\\orders.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'roleFilter' is assigned a value but never used.",
                "line": 36,
                "column": 13,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 36,
                "endColumn": 23
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'orderId' is assigned a value but never used.",
                "line": 174,
                "column": 19,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 174,
                "endColumn": 26
            }
        ],
        "suppressedMessages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchUserAndOrders'. Either include it or remove the dependency array.",
                "line": 18,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 18,
                "endColumn": 17,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [activeTab, fetchUserAndOrders]",
                        "fix": {
                            "range": [
                                795,
                                806
                            ],
                            "text": "[activeTab, fetchUserAndOrders]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, Alert, ScrollView, Text, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function Orders() {\r\n  const router = useRouter();\r\n  const [userType, setUserType] = useState<\"farmer\" | \"buyer\" | null>(null);\r\n  const [activeTab, setActiveTab] = useState(\"active\"); // 'active' | 'completed'\r\n  const [orders, setOrders] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchUserAndOrders();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [activeTab]);\r\n\r\n  const fetchUserAndOrders = async () => {\r\n    setLoading(true);\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (user) {\r\n      // 1. Get user role\r\n      const { data: profile } = await supabase\r\n        .from('profiles')\r\n        .select('role')\r\n        .eq('id', user.id)\r\n        .single();\r\n\r\n      const type = profile?.role || \"buyer\";\r\n      setUserType(type);\r\n\r\n      // 2. Fetch Orders\r\n      // Query filter depends on role\r\n      const roleFilter = type === 'farmer' ? 'product.farmer_id' : 'buyer_id';\r\n\r\n      if (type === 'buyer') {\r\n        const { data: ordersData, error } = await supabase\r\n          .from('orders')\r\n          .select(`\r\n                *,\r\n                items:order_items (\r\n                    *,\r\n                    product:products (name, price)\r\n                )\r\n            `)\r\n          .eq('buyer_id', user.id)\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (error) console.error(error);\r\n\r\n        // Client-side status filter\r\n        const filtered = (ordersData || []).filter(o => {\r\n          const isComplete = ['delivered', 'cancelled'].includes(o.status);\r\n          return activeTab === 'active' ? !isComplete : isComplete;\r\n        });\r\n        setOrders(filtered);\r\n\r\n      } else if (type === 'farmer') {\r\n        // For farmers, get items they sold\r\n        // We query order_items -> products where farmer_id = me\r\n        const { data: itemsData, error } = await supabase\r\n          .from('order_items')\r\n          .select(`\r\n                *,\r\n                order:orders (id, created_at, status, buyer_id),\r\n                product:products!inner (name, farmer_id)\r\n            `)\r\n          .eq('product.farmer_id', user.id)\r\n          .order('created_at', { foreignTable: 'order', ascending: false });\r\n\r\n        if (error) console.error(error);\r\n\r\n        // Group items by Order? Or just list items to ship.\r\n        // Listing items to ship is often clearer for farmers.\r\n        // Filter by status of the PARENT order?\r\n        const filtered = (itemsData || []).filter(item => {\r\n          const status = item.order?.status || 'pending';\r\n          const isComplete = ['delivered', 'cancelled'].includes(status);\r\n          return activeTab === 'active' ? !isComplete : isComplete;\r\n        });\r\n        setOrders(filtered);\r\n      }\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status?.toLowerCase()) {\r\n      case 'pending': return \"bg-yellow-100 text-yellow-800\";\r\n      case 'shipped': return \"bg-blue-100 text-blue-800\";\r\n      case 'delivered': return \"bg-green-100 text-green-800\";\r\n      case 'cancelled': return \"bg-red-100 text-red-800\";\r\n      default: return \"bg-gray-100 text-gray-800\";\r\n    }\r\n  };\r\n\r\n  // Only Farmers should update status\r\n  const handleUpdateStatus = async (orderId: string, itemStatus: string, currentStatus: string) => {\r\n    // If we are updating the main ORDER status (assuming 1-1 mapping for simplicity or updating parent)\r\n    // If Farmer, we update the Order status.\r\n    if (userType !== 'farmer') return;\r\n\r\n    const nextStatus = currentStatus === 'pending' ? 'shipped' : 'delivered';\r\n\r\n    Alert.alert(\r\n      \"Update Order\",\r\n      `Mark order as ${nextStatus}?`,\r\n      [\r\n        { text: \"Cancel\" },\r\n        {\r\n          text: \"Confirm\",\r\n          onPress: async () => {\r\n            const { error } = await supabase\r\n              .from('orders')\r\n              .update({ status: nextStatus })\r\n              .eq('id', orderId);\r\n\r\n            if (error) Alert.alert(\"Error\", error.message);\r\n            else fetchUserAndOrders();\r\n          }\r\n        }\r\n      ]\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n        <ActivityIndicator size=\"large\" color=\"#22c55e\" />\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <SafeAreaView className=\"flex-1 bg-white\">\r\n      <StatusBar style=\"dark\" />\r\n\r\n      <View>\r\n        <Text className=\"text-2xl font-bold text-green-800\">My Orders</Text>\r\n        <Text className=\"text-gray-600 text-sm\">\r\n          {userType === 'farmer' ? 'Manage detailed sales' : 'Purchase history'}\r\n        </Text>\r\n      </View>\r\n\r\n      {/* Tabs */}\r\n      <View className=\"flex-row px-6 border-b border-gray-200\">\r\n        <TouchableOpacity\r\n          className={`flex-1 py-4 border-b-2 ${activeTab === 'active' ? 'border-green-500' : 'border-transparent'}`}\r\n          onPress={() => setActiveTab(\"active\")}\r\n        >\r\n          <Text className={`text-center font-medium ${activeTab === 'active' ? 'text-green-600' : 'text-gray-500'}`}>\r\n            Active\r\n          </Text>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity\r\n          className={`flex-1 py-4 border-b-2 ${activeTab === 'completed' ? 'border-green-500' : 'border-transparent'}`}\r\n          onPress={() => setActiveTab(\"completed\")}\r\n        >\r\n          <Text className={`text-center font-medium ${activeTab === 'completed' ? 'text-green-600' : 'text-gray-500'}`}>\r\n            Completed\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n\r\n      <ScrollView className=\"flex-1 px-4 py-4\">\r\n        {orders.length > 0 ? (\r\n          orders.map((item) => {\r\n            // Determine structure based on role\r\n            // Buyer sees ORDERS (with nested items)\r\n            // Farmer sees ORDER_ITEMS (with nested order info)\r\n            const isBuyer = userType === 'buyer';\r\n            const orderId = isBuyer ? item.id : item.order?.id;\r\n            const status = isBuyer ? item.status : item.order?.status;\r\n            // For buyer, item is Order (has created_at). For farmer, item is OrderItem (needs item.order.created_at)\r\n            const date = isBuyer ? item.created_at : item.order?.created_at;\r\n\r\n            // For displaying content\r\n            const displayTitle = isBuyer\r\n              ? `Order #${item.id.substring(0, 8)}`\r\n              : item.product?.name;\r\n\r\n            const displaySub = isBuyer\r\n              ? `${item.items?.length || 0} items ‚Ä¢ $${item.total_amount}`\r\n              : `Qty: ${item.quantity} ‚Ä¢ Order #${item.order?.id.substring(0, 8)}`;\r\n\r\n            return (\r\n              <View key={item.id} className=\"bg-white rounded-xl p-4 border border-gray-200 shadow-sm mb-4\">\r\n                <View className=\"flex-row justify-between items-start mb-2\">\r\n                  <View className=\"flex-1\">\r\n                    <Text className=\"font-bold text-gray-800 text-lg\">{displayTitle}</Text>\r\n                    <Text className=\"text-gray-600 text-sm mt-1\">{displaySub}</Text>\r\n                  </View>\r\n                  <View className={`px-2 py-1 rounded-full ${getStatusColor(status).split(' ')[0]}`}>\r\n                    <Text className={`text-xs font-bold ${getStatusColor(status).split(' ')[1]}`}>\r\n                      {status?.toUpperCase()}\r\n                    </Text>\r\n                  </View>\r\n                </View>\r\n\r\n                {/* Buyers see list of items */}\r\n                {isBuyer && item.items?.map((orderItem: any) => (\r\n                  <Text key={orderItem.id} className=\"text-gray-500 text-xs ml-2\">\r\n                    ‚Ä¢ {orderItem.product?.name} (x{orderItem.quantity})\r\n                  </Text>\r\n                ))}\r\n\r\n                <View className=\"flex-row justify-between items-center mt-3 pt-3 border-t border-gray-100\">\r\n                  <Text className=\"text-xs text-gray-400\">\r\n                    {new Date(date).toLocaleDateString()}\r\n                  </Text>\r\n\r\n                  {userType === 'farmer' && activeTab === 'active' && (\r\n                    <TouchableOpacity\r\n                      onPress={() => handleUpdateStatus(item.order.id, status, status)}\r\n                      className=\"bg-green-600 px-4 py-2 rounded-lg\"\r\n                    >\r\n                      <Text className=\"text-white text-xs font-bold\">Update Status</Text>\r\n                    </TouchableOpacity>\r\n                  )}\r\n\r\n                  {userType === 'buyer' && status === 'delivered' && (\r\n                    <TouchableOpacity\r\n                      onPress={() => router.push({ pathname: \"/submit-review\", params: { orderId: item.id, productId: item.items?.[0]?.product_id, productName: item.items?.[0]?.product?.name } })}\r\n                      className=\"bg-blue-600 px-4 py-2 rounded-lg\"\r\n                    >\r\n                      <Text className=\"text-white text-xs font-bold\">Review Product</Text>\r\n                    </TouchableOpacity>\r\n                  )}\r\n                </View>\r\n              </View>\r\n            );\r\n          })\r\n        ) : (\r\n          <View className=\"py-20 items-center\">\r\n            <Text className=\"text-gray-400 text-lg\">No orders found.</Text>\r\n          </View>\r\n        )}\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\(tabs)\\profile.tsx",
        "messages": [
            {
                "ruleId": null,
                "message": "Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').",
                "line": 24,
                "column": 5,
                "severity": 1,
                "nodeType": null,
                "fix": {
                    "range": [
                        853,
                        908
                    ],
                    "text": " "
                }
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'error' is defined but never used.",
                "line": 81,
                "column": 14,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 81,
                "endColumn": 19
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 1,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Alert, ScrollView, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function Profile() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editing, setEditing] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    full_name: \"\",\r\n    farm_name: \"\",\r\n    phone: \"\",\r\n    address: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    getCurrentUser();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const getCurrentUser = async () => {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (user) {\r\n        const { data: profile } = await supabase\r\n          .from('profiles')\r\n          .select('*')\r\n          .eq('id', user.id)\r\n          .single();\r\n\r\n        setUser({ ...user, ...profile });\r\n        setFormData({\r\n          full_name: profile?.full_name || \"\",\r\n          farm_name: profile?.farm_name || \"\",\r\n          phone: profile?.phone || \"\",\r\n          address: profile?.address || \"\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching user:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateProfile = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('profiles')\r\n        .update(formData)\r\n        .eq('id', user.id);\r\n\r\n      if (error) {\r\n        Alert.alert(\"Update Error\", error.message);\r\n        return;\r\n      }\r\n\r\n      Alert.alert(\"Success\", \"Profile updated successfully!\");\r\n      setEditing(false);\r\n      getCurrentUser(); // Refresh data\r\n    } catch (error) {\r\n      console.error('Update error:', error);\r\n      Alert.alert(\"Error\", \"Failed to update profile\");\r\n    }\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await AsyncStorage.setItem('logging_out', 'true');\r\n      (router as any).replace(\"/\");\r\n      await supabase.auth.signOut();\r\n      await AsyncStorage.removeItem('user_session');\r\n    } catch (error) {\r\n      (router as any).replace(\"/\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n        <Text className=\"text-lg text-gray-600\">Loading...</Text>\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  const profileStats = (user?.role === 'farmer' || user?.user_type === 'farmer') ? [\r\n    { label: \"Products\", value: user.products_count || \"0\", emoji: \"üì¶\" },\r\n    { label: \"Total Sales\", value: \"$2,450\", emoji: \"üí∞\" },\r\n    { label: \"Rating\", value: \"4.8\", emoji: \"‚≠ê\" },\r\n    { label: \"Customers\", value: \"45\", emoji: \"üë•\" },\r\n  ] : [\r\n    { label: \"Orders\", value: \"8\", emoji: \"üõí\" },\r\n    { label: \"Total Spent\", value: \"$320\", emoji: \"üí∞\" },\r\n    { label: \"Favorites\", value: \"6\", emoji: \"‚ù§Ô∏è\" },\r\n    { label: \"Reviews\", value: \"3\", emoji: \"‚≠ê\" },\r\n  ];\r\n\r\n  return (\r\n    <SafeAreaView className=\"flex-1 bg-white\">\r\n      <StatusBar style=\"dark\" />\r\n\r\n      {/* Header */}\r\n      <View className=\"px-6 py-4 bg-green-50 flex-row justify-between items-center\">\r\n        <Text className=\"text-2xl font-bold text-green-800\">Profile</Text>\r\n      </View>\r\n\r\n      <ScrollView className=\"flex-1\" showsVerticalScrollIndicator={false}>\r\n        {/* Profile Header */}\r\n        <View className=\"bg-white p-6 border-b border-gray-100\">\r\n          <View className=\"flex-row items-center mb-6\">\r\n            <View className=\"w-16 h-16 bg-green-100 rounded-full items-center justify-center mr-4\">\r\n              <Text className=\"text-3xl\">üë§</Text>\r\n            </View>\r\n            <View className=\"flex-1\">\r\n              <Text className=\"text-xl font-bold text-gray-900\">{user?.full_name || 'Agri User'}</Text>\r\n              <Text className=\"text-gray-500 capitalize\">{user?.role || user?.user_type || 'Consumer'}</Text>\r\n            </View>\r\n            <TouchableOpacity\r\n              onPress={() => router.push(\"/edit-profile\")}\r\n              className=\"bg-gray-50 p-3 rounded-full border border-gray-100\"\r\n            >\r\n              <Ionicons name=\"pencil\" size={20} color=\"#16a34a\" />\r\n            </TouchableOpacity>\r\n          </View>\r\n          {user?.farm_name && (\r\n            <Text className=\"text-green-600 font-medium mt-1\">\r\n              {user.farm_name}\r\n            </Text>\r\n          )}\r\n        </View>\r\n\r\n        {/* Statistiques */}\r\n        <View className=\"px-6 py-4\">\r\n          <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"flex-row\">\r\n            {profileStats.map((stat, index) => (\r\n              <View key={index} className=\"bg-green-50 rounded-xl p-4 mr-4 w-32 border border-green-100\">\r\n                <Text className=\"text-green-800 font-bold\">{stat.value}</Text>\r\n                <Text className=\"text-xs text-green-600 mt-1\">{stat.label}</Text>\r\n              </View>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n\r\n        {/* Informations du profil */}\r\n        <View className=\"px-6 py-4\">\r\n          <View className=\"flex-row justify-between items-center mb-4\">\r\n            <Text className=\"text-lg font-bold text-gray-800\">Profile Information</Text>\r\n            <TouchableOpacity\r\n              onPress={() => setEditing(!editing)}\r\n              className=\"bg-green-500 rounded-lg px-3 py-1\"\r\n            >\r\n              <Text className=\"text-white font-medium\">\r\n                {editing ? \"Cancel\" : \"Edit\"}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n\r\n          <View className=\"space-y-4\">\r\n            <View>\r\n              <Text className=\"text-gray-700 font-medium mb-2\">Full Name</Text>\r\n              {editing ? (\r\n                <TextInput\r\n                  value={formData.full_name}\r\n                  onChangeText={(text) => setFormData({ ...formData, full_name: text })}\r\n                  className=\"bg-gray-100 rounded-xl px-4 py-3 text-gray-700 border border-gray-300\"\r\n                />\r\n              ) : (\r\n                <Text className=\"text-gray-800 bg-gray-100 rounded-xl px-4 py-3\">\r\n                  {user?.full_name || \"Not set\"}\r\n                </Text>\r\n              )}\r\n            </View>\r\n\r\n            {(user?.role === 'farmer' || user?.user_type === 'farmer') && (\r\n              <View>\r\n                <Text className=\"text-gray-700 font-medium mb-2\">Farm Name</Text>\r\n                {editing ? (\r\n                  <TextInput\r\n                    value={formData.farm_name}\r\n                    onChangeText={(text) => setFormData({ ...formData, farm_name: text })}\r\n                    className=\"bg-gray-100 rounded-xl px-4 py-3 text-gray-700 border border-gray-300\"\r\n                  />\r\n                ) : (\r\n                  <Text className=\"text-gray-800 bg-gray-100 rounded-xl px-4 py-3\">\r\n                    {user?.farm_name || \"Not set\"}\r\n                  </Text>\r\n                )}\r\n              </View>\r\n            )}\r\n\r\n            <View>\r\n              <Text className=\"text-gray-700 font-medium mb-2\">Email</Text>\r\n              <Text className=\"text-gray-800 bg-gray-100 rounded-xl px-4 py-3\">\r\n                {user?.email}\r\n              </Text>\r\n            </View>\r\n\r\n            <View>\r\n              <Text className=\"text-gray-700 font-medium mb-2\">Phone</Text>\r\n              {editing ? (\r\n                <TextInput\r\n                  value={formData.phone}\r\n                  onChangeText={(text) => setFormData({ ...formData, phone: text })}\r\n                  className=\"bg-gray-100 rounded-xl px-4 py-3 text-gray-700 border border-gray-300\"\r\n                  keyboardType=\"phone-pad\"\r\n                />\r\n              ) : (\r\n                <Text className=\"text-gray-800 bg-gray-100 rounded-xl px-4 py-3\">\r\n                  {user?.phone || \"Not set\"}\r\n                </Text>\r\n              )}\r\n            </View>\r\n\r\n            <View>\r\n              <Text className=\"text-gray-700 font-medium mb-2\">Address</Text>\r\n              {editing ? (\r\n                <TextInput\r\n                  value={formData.address}\r\n                  onChangeText={(text) => setFormData({ ...formData, address: text })}\r\n                  className=\"bg-gray-100 rounded-xl px-4 py-3 text-gray-700 border border-gray-300\"\r\n                  multiline\r\n                />\r\n              ) : (\r\n                <Text className=\"text-gray-800 bg-gray-100 rounded-xl px-4 py-3\">\r\n                  {user?.address || \"Not set\"}\r\n                </Text>\r\n              )}\r\n            </View>\r\n\r\n            {editing && (\r\n              <TouchableOpacity\r\n                className=\"bg-green-600 rounded-xl py-4 mt-4\"\r\n                onPress={handleUpdateProfile}\r\n              >\r\n                <Text className=\"text-white text-center font-bold text-lg\">\r\n                  Save Changes\r\n                </Text>\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n        </View>\r\n\r\n        {/* Actions */}\r\n        <View className=\"px-6 py-6\">\r\n          <Text className=\"text-lg font-bold text-gray-800 mb-4\">Account Actions</Text>\r\n          <View className=\"space-y-3\">\r\n            <TouchableOpacity className=\"bg-white border border-gray-300 rounded-xl p-4 flex-row items-center\">\r\n              <Text className=\"text-2xl mr-4\">üîî</Text>\r\n              <Text className=\"text-gray-800 font-medium flex-1\">Notifications</Text>\r\n              <Text className=\"text-gray-400\">‚Üí</Text>\r\n            </TouchableOpacity>\r\n\r\n            <TouchableOpacity className=\"bg-white border border-gray-300 rounded-xl p-4 flex-row items-center\">\r\n              <Text className=\"text-2xl mr-4\">üõ°Ô∏è</Text>\r\n              <Text className=\"text-gray-800 font-medium flex-1\">Privacy & Security</Text>\r\n              <Text className=\"text-gray-400\">‚Üí</Text>\r\n            </TouchableOpacity>\r\n\r\n            <TouchableOpacity className=\"bg-white border border-gray-300 rounded-xl p-4 flex-row items-center\">\r\n              <Text className=\"text-2xl mr-4\">‚ùì</Text>\r\n              <Text className=\"text-gray-800 font-medium flex-1\">Help & Support</Text>\r\n              <Text className=\"text-gray-400\">‚Üí</Text>\r\n            </TouchableOpacity>\r\n\r\n            <TouchableOpacity\r\n              className=\"bg-red-50 border border-red-200 rounded-xl p-4 flex-row items-center\"\r\n              onPress={() => {\r\n                console.log(\"[Profile] Logout manual press\");\r\n                handleLogout();\r\n              }}\r\n              activeOpacity={0.7}\r\n              hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\r\n            >\r\n              <Text className=\"text-2xl mr-4\">üö™</Text>\r\n              <Text className=\"text-red-600 font-medium flex-1\">Logout</Text>\r\n              <Text className=\"text-red-400\">‚Üí</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  );\r\n}",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\(tabs)\\search.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'setActiveFilter' is assigned a value but never used.",
                "line": 11,
                "column": 24,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 11,
                "endColumn": 39
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'loadProducts'. Either include it or remove the dependency array.",
                "line": 23,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 23,
                "endColumn": 24,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [loadProducts, selectedCategory]",
                        "fix": {
                            "range": [
                                919,
                                937
                            ],
                            "text": "[loadProducts, selectedCategory]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from \"@/lib/supabaseClient\";\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ScrollView, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function Search() {\r\n  const router = useRouter();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [activeFilter, setActiveFilter] = useState(\"all\");\r\n  const [userType, setUserType] = useState<\"farmer\" | \"buyer\">(\"buyer\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [products, setProducts] = useState<any[]>([]);\r\n  const [farms, setFarms] = useState<any[]>([]);\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadUserType();\r\n    loadProducts();\r\n    loadFarms();\r\n  }, [selectedCategory]);\r\n\r\n  // ------------------------- GET USER TYPE -------------------------\r\n  const loadUserType = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) return;\r\n\r\n    const { data } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"role\")\r\n      .eq(\"id\", user.id)\r\n      .single();\r\n\r\n    setUserType(data?.role || \"buyer\");\r\n  };\r\n\r\n  // ------------------------- LOAD PRODUCTS -------------------------\r\n  const loadProducts = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // 1. Fetch products\r\n      let query = supabase\r\n        .from(\"products\")\r\n        .select(\"id, name, category, price, rating, farmer_id\");\r\n\r\n      if (selectedCategory) {\r\n        query = query.eq('category', selectedCategory);\r\n      }\r\n\r\n      const { data: productsData, error: productsError } = await query;\r\n\r\n      if (productsError) throw productsError;\r\n\r\n      if (!productsData) {\r\n        setProducts([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // 2. Get Farmer IDs\r\n      const farmerIds = [...new Set(productsData.map(p => p.farmer_id).filter(Boolean))];\r\n\r\n      // 3. Fetch Farmers\r\n      let farmersMap: Record<string, any> = {};\r\n      if (farmerIds.length > 0) {\r\n        const { data: farmersData } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, full_name, farm_name\")\r\n          .in(\"id\", farmerIds);\r\n\r\n        if (farmersData) {\r\n          farmersMap = farmersData.reduce((acc, f) => ({ ...acc, [f.id]: f }), {});\r\n        }\r\n      }\r\n\r\n      // 4. Merge\r\n      const mappedProducts = productsData.map(p => ({\r\n        ...p,\r\n        farmer: farmersMap[p.farmer_id] || { full_name: \"Unknown\", farm_name: \"Unknown Farm\" }\r\n      }));\r\n\r\n      setProducts(mappedProducts);\r\n\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // ------------------------- LOAD FARMS -------------------------\r\n  const loadFarms = async () => {\r\n    const { data, error } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"id, full_name, farm_name, rating, role\")\r\n      .eq(\"role\", \"farmer\");\r\n\r\n    if (!error && data) setFarms(data);\r\n  };\r\n\r\n  // ------------------------- FILTER LOGIC -------------------------\r\n  const filteredProducts = products.filter((item) =>\r\n    item.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  const filteredFarms = farms.filter((farm) =>\r\n    farm.full_name.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  // ------------------------- RENDER PRODUCT -------------------------\r\n  const renderProduct = (item: any) => (\r\n    <TouchableOpacity\r\n      key={item.id}\r\n      className=\"bg-white rounded-2xl p-4 border border-gray-200 shadow-sm mb-3\"\r\n      onPress={() => router.push({ pathname: \"/product-details\", params: { id: item.id } })}\r\n    >\r\n      <View className=\"flex-row items-center\">\r\n        <View className=\"w-16 h-16 bg-green-100 rounded-xl items-center justify-center mr-4\">\r\n          <Text className=\"text-2xl\">{item.category === \"fruits\" ? \"üçé\" : \"ü•¨\"}</Text>\r\n        </View>\r\n\r\n        <View className=\"flex-1\">\r\n          <Text className=\"font-bold text-gray-800 text-lg\">{item.name}</Text>\r\n          <Text className=\"text-gray-600 text-sm\">\r\n            {item.farmer?.farm_name || item.farmer?.full_name}\r\n          </Text>\r\n\r\n          <View className=\"flex-row items-center justify-between mt-1\">\r\n            <Text className=\"text-green-600 font-bold\">${item.price}/kg</Text>\r\n            <Text className=\"text-yellow-500\">‚≠ê {item.rating || \"4.5\"}</Text>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  // ------------------------- RENDER FARM -------------------------\r\n  const renderFarm = (farm: any) => (\r\n    <TouchableOpacity\r\n      key={farm.id}\r\n      className=\"bg-white rounded-2xl p-4 border border-gray-200 shadow-sm mb-3\"\r\n    >\r\n      <View className=\"flex-row items-center\">\r\n        <View className=\"w-16 h-16 bg-blue-100 rounded-xl items-center justify-center mr-4\">\r\n          <Text className=\"text-2xl\">üèûÔ∏è</Text>\r\n        </View>\r\n\r\n        <View className=\"flex-1\">\r\n          <Text className=\"font-bold text-gray-800 text-lg\">{farm.full_name}</Text>\r\n          <Text className=\"text-gray-600 text-sm\">\r\n            {farm.farm_name || \"Local Farm\"}\r\n          </Text>\r\n\r\n          <View className=\"flex-row items-center justify-between mt-1\">\r\n            <Text className=\"text-yellow-500\">‚≠ê {farm.rating || \"4.7\"}</Text>\r\n            <Text className=\"text-blue-600 font-bold\">Visit</Text>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  return (\r\n    <SafeAreaView className=\"flex-1 bg-white\">\r\n      <StatusBar style=\"dark\" />\r\n\r\n      {/* HEADER */}\r\n      <View>\r\n        <Text className=\"text-2xl font-bold text-green-800\">Search</Text>\r\n        <Text className=\"text-gray-600 text-sm\">\r\n          {userType === \"farmer\"\r\n            ? \"Find buyers and demand\"\r\n            : \"Find fresh products and local farms\"}\r\n        </Text>\r\n      </View>\r\n\r\n      {/* SEARCH BAR */}\r\n      <View className=\"px-6 py-4\">\r\n        <View className=\"bg-gray-100 rounded-2xl px-4 py-3 flex-row items-center mb-4\">\r\n          <TextInput\r\n            placeholder=\"Search products or farms...\"\r\n            className=\"flex-1 text-gray-700 text-base\"\r\n            value={searchQuery}\r\n            onChangeText={setSearchQuery}\r\n          />\r\n          <Text className=\"text-gray-400 text-lg\">üîç</Text>\r\n        </View>\r\n\r\n        {/* CATEGORY FILTERS */}\r\n        <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"flex-row\">\r\n          <TouchableOpacity\r\n            onPress={() => setSelectedCategory(null)}\r\n            className={`px-4 py-2 rounded-full mr-2 ${!selectedCategory ? 'bg-green-600' : 'bg-gray-100'}`}\r\n          >\r\n            <Text className={`${!selectedCategory ? 'text-white' : 'text-gray-600'} font-bold text-xs`}>All</Text>\r\n          </TouchableOpacity>\r\n          {['fruits', 'vegetables', 'dairy', 'grains', 'meat'].map((cat) => (\r\n            <TouchableOpacity\r\n              key={cat}\r\n              onPress={() => setSelectedCategory(cat)}\r\n              className={`px-4 py-2 rounded-full mr-2 ${selectedCategory === cat ? 'bg-green-600' : 'bg-gray-100'}`}\r\n            >\r\n              <Text className={`${selectedCategory === cat ? 'text-white' : 'text-gray-600'} font-bold text-xs capitalize`}>{cat}</Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n      </View>\r\n\r\n      {/* RESULTS */}\r\n      <ScrollView className=\"px-6 pb-10\">\r\n        {/* PRODUCTS */}\r\n        {(activeFilter === \"all\" || activeFilter === \"products\") &&\r\n          filteredProducts.length > 0 && (\r\n            <>\r\n              <Text className=\"text-lg font-bold text-gray-800 mb-3\">Products</Text>\r\n              {filteredProducts.map(renderProduct)}\r\n            </>\r\n          )}\r\n\r\n        {/* FARMS */}\r\n        {(activeFilter === \"all\" || activeFilter === \"farms\") &&\r\n          filteredFarms.length > 0 && (\r\n            <>\r\n              <Text className=\"text-lg font-bold text-gray-800 mt-4 mb-3\">Farms</Text>\r\n              {filteredFarms.map(renderFarm)}\r\n            </>\r\n          )}\r\n\r\n        {/* NO RESULT */}\r\n        {!loading && searchQuery && filteredProducts.length === 0 && filteredFarms.length === 0 && (\r\n          <View className=\"items-center mt-20\">\r\n            <Text className=\"text-4xl\">üòï</Text>\r\n            <Text className=\"text-gray-600 mt-2\">No results found.</Text>\r\n          </View>\r\n        )}\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\_layout.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'router'. Either include it or remove the dependency array.",
                "line": 27,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 27,
                "endColumn": 8,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [router]",
                        "fix": {
                            "range": [
                                757,
                                759
                            ],
                            "text": "[router]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from \"@/lib/supabaseClient\";\nimport { Stack, useRouter } from \"expo-router\";\nimport { useEffect } from \"react\";\nimport { SafeAreaProvider } from \"react-native-safe-area-context\";\nimport \"./globals.css\";\n\nexport default function RootLayout() {\n  const router = useRouter();\n\n  useEffect(() => {\n    console.log(\"[RootLayout] Initializing Auth Listener...\");\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      (_event, session) => {\n        console.log(\"[RootLayout] Auth event:\", _event);\n\n        // Si d√©connect√© ou pas de session, remplacer la stack vers login\n        if (!session) {\n          router.replace(\"/\");\n        }\n      }\n    );\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, []);\n\n\n  return (\n    <SafeAreaProvider>\n      <Stack screenOptions={{ headerShown: false }}>\n        <Stack.Screen name=\"index\" />\n        <Stack.Screen name=\"signup\" />\n        <Stack.Screen name=\"(tabs)\" />\n        <Stack.Screen name=\"add-product\" />\n        <Stack.Screen name=\"add-supply\" />\n        <Stack.Screen name=\"cart\" />\n        <Stack.Screen name=\"edit-profile\" />\n        <Stack.Screen name=\"supply-market\" />\n        <Stack.Screen name=\"supply-details\" />\n        <Stack.Screen name=\"supplier-profile\" />\n        <Stack.Screen name=\"product-details\" />\n        <Stack.Screen name=\"submit-review\" />\n        <Stack.Screen name=\"farmer-profile\" />\n      </Stack>\n    </SafeAreaProvider>\n  );\n}",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\add-product.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'error' is assigned a value but never used.",
                "line": 28,
                "column": 19,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 28,
                "endColumn": 24
            }
        ],
        "suppressedMessages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchProductDetails'. Either include it or remove the dependency array.",
                "line": 25,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 25,
                "endColumn": 10,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [fetchProductDetails, id]",
                        "fix": {
                            "range": [
                                1048,
                                1052
                            ],
                            "text": "[fetchProductDetails, id]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from \"@/lib/supabaseClient\";\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, Alert, KeyboardAvoidingView, Platform, ScrollView, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function AddProduct() {\r\n  const router = useRouter();\r\n  const { id } = useLocalSearchParams(); // Get ID if editing\r\n  const [name, setName] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [price, setPrice] = useState(\"\");\r\n  const [stock, setStock] = useState(\"\");\r\n  const [category, setCategory] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const isEditing = !!id; // Derived state\r\n\r\n  // Fetch product if editing\r\n  useEffect(() => {\r\n    if (id) {\r\n      fetchProductDetails();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  async function fetchProductDetails() {\r\n    const { data, error } = await supabase\r\n      .from('products')\r\n      .select('*')\r\n      .eq('id', id)\r\n      .single();\r\n\r\n    if (data) {\r\n      setName(data.name);\r\n      setDescription(data.description || '');\r\n      setPrice(data.price.toString());\r\n      setStock(data.stock.toString());\r\n      setCategory(data.category ? data.category.charAt(0).toUpperCase() + data.category.slice(1) : '');\r\n    }\r\n  }\r\n\r\n  const CATEGORIES = ['Fruits', 'Vegetables', 'Dairy', 'Grains', 'Meat', 'Herbs', 'Eggs', 'Honey', 'Nuts', 'Seafood'];\r\n\r\n  const handleAddProduct = async () => {\r\n    if (!name.trim() || !price || !stock || !category) {\r\n      Alert.alert(\"Missing Information\", \"Please fill in all required fields (Name, Price, Stock, Category)\");\r\n      return;\r\n    }\r\n\r\n    const priceValue = parseFloat(price);\r\n    const stockValue = parseInt(stock);\r\n\r\n    if (isNaN(priceValue) || priceValue <= 0) {\r\n      Alert.alert(\"Invalid Price\", \"Price must be a valid number greater than 0\");\r\n      return;\r\n    }\r\n\r\n    if (isNaN(stockValue) || stockValue < 0) {\r\n      Alert.alert(\"Invalid Stock\", \"Stock must be a valid number (0 or more)\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // 1. Get current user\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n      const currentUserId = user.id;\r\n\r\n      // 2. Insert into 'products' table\r\n      // 2. Insert or Update\r\n      if (isEditing) {\r\n        const { error } = await supabase\r\n          .from(\"products\")\r\n          .update({\r\n            name: name.trim(),\r\n            description: description.trim() || null,\r\n            price: priceValue,\r\n            stock: stockValue,\r\n            category: category.toLowerCase(),\r\n          })\r\n          .eq('id', id);\r\n        if (error) throw error;\r\n      } else {\r\n        const { error } = await supabase.from(\"products\").insert({\r\n          farmer_id: currentUserId,\r\n          name: name.trim(),\r\n          description: description.trim() || null,\r\n          price: priceValue,\r\n          stock: stockValue,\r\n          category: category.toLowerCase(),\r\n        });\r\n        if (error) throw error;\r\n      }\r\n\r\n      Alert.alert(\r\n        \"Success! üéâ\",\r\n        `Product ${isEditing ? 'updated' : 'added'} successfully`,\r\n        [\r\n          { text: \"OK\", onPress: () => router.back() }\r\n        ]\r\n      );\r\n\r\n    } catch (err: any) {\r\n      console.error(\"Add product error:\", err);\r\n      Alert.alert(\"Error\", err.message || \"Failed to add product\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView className=\"flex-1 bg-white\">\r\n      <KeyboardAvoidingView\r\n        behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\r\n        className=\"flex-1\"\r\n      >\r\n        <ScrollView className=\"flex-1 px-6 pt-4\" showsVerticalScrollIndicator={false}>\r\n          {/* Header */}\r\n          <View className=\"flex-row items-center mb-6\">\r\n            <TouchableOpacity onPress={() => router.back()} className=\"mr-4 p-2 bg-gray-100 rounded-full\">\r\n              <Ionicons name=\"arrow-back\" size={24} color=\"#374151\" />\r\n            </TouchableOpacity>\r\n            <Text className=\"text-2xl font-bold text-gray-800\">{isEditing ? 'Edit Product' : 'Add New Product'}</Text>\r\n          </View>\r\n\r\n          <View className=\"space-y-4\">\r\n            {/* Name */}\r\n            <View>\r\n              <Text className=\"text-sm font-semibold text-gray-700 mb-1\">Product Name *</Text>\r\n              <TextInput\r\n                placeholder=\"e.g. Fresh Tomatoes\"\r\n                value={name}\r\n                onChangeText={setName}\r\n                className=\"border border-gray-300 p-4 rounded-xl bg-gray-50 text-gray-800\"\r\n                placeholderTextColor=\"#9CA3AF\"\r\n              />\r\n            </View>\r\n\r\n            {/* Description */}\r\n            <View>\r\n              <Text className=\"text-sm font-semibold text-gray-700 mb-1\">Description</Text>\r\n              <TextInput\r\n                placeholder=\"Describe your product...\"\r\n                value={description}\r\n                onChangeText={setDescription}\r\n                multiline\r\n                numberOfLines={4}\r\n                textAlignVertical=\"top\"\r\n                className=\"border border-gray-300 p-4 rounded-xl bg-gray-50 text-gray-800 h-32\"\r\n                placeholderTextColor=\"#9CA3AF\"\r\n              />\r\n            </View>\r\n\r\n            <View className=\"flex-row space-x-4\">\r\n              {/* Price */}\r\n              <View className=\"flex-1\">\r\n                <Text className=\"text-sm font-semibold text-gray-700 mb-1\">Price (DA) *</Text>\r\n                <TextInput\r\n                  placeholder=\"0.00\"\r\n                  value={price}\r\n                  onChangeText={setPrice}\r\n                  keyboardType=\"numeric\"\r\n                  className=\"border border-gray-300 p-4 rounded-xl bg-gray-50 text-gray-800\"\r\n                  placeholderTextColor=\"#9CA3AF\"\r\n                />\r\n              </View>\r\n\r\n              {/* Stock */}\r\n              <View className=\"flex-1\">\r\n                <Text className=\"text-sm font-semibold text-gray-700 mb-1\">Stock (Qty) *</Text>\r\n                <TextInput\r\n                  placeholder=\"0\"\r\n                  value={stock}\r\n                  onChangeText={setStock}\r\n                  keyboardType=\"numeric\"\r\n                  className=\"border border-gray-300 p-4 rounded-xl bg-gray-50 text-gray-800\"\r\n                  placeholderTextColor=\"#9CA3AF\"\r\n                />\r\n              </View>\r\n            </View>\r\n\r\n            {/* Category */}\r\n            <View>\r\n              <Text className=\"text-sm font-semibold text-gray-700 mb-2\">Category *</Text>\r\n              <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"flex-row\">\r\n                {CATEGORIES.map((cat) => (\r\n                  <TouchableOpacity\r\n                    key={cat}\r\n                    onPress={() => setCategory(cat)}\r\n                    className={`mr-2 px-4 py-2 rounded-full border ${category === cat\r\n                      ? 'bg-green-600 border-green-600'\r\n                      : 'bg-white border-gray-300'\r\n                      }`}\r\n                  >\r\n                    <Text\r\n                      className={`font-semibold ${category === cat ? 'text-white' : 'text-gray-600'\r\n                        }`}\r\n                    >\r\n                      {cat}\r\n                    </Text>\r\n                  </TouchableOpacity>\r\n                ))}\r\n              </ScrollView>\r\n            </View>\r\n          </View>\r\n\r\n          {/* Action Button */}\r\n          <TouchableOpacity\r\n            onPress={handleAddProduct}\r\n            disabled={loading}\r\n            className={`mt-8 py-4 rounded-xl items-center shadow-md ${loading ? 'bg-green-400' : 'bg-green-600'\r\n              }`}\r\n          >\r\n            {loading ? (\r\n              <ActivityIndicator color=\"#fff\" />\r\n            ) : (\r\n              <Text className=\"text-white font-bold text-lg\">{isEditing ? 'Update Product' : 'Add Product'}</Text>\r\n            )}\r\n          </TouchableOpacity>\r\n        </ScrollView>\r\n      </KeyboardAvoidingView>\r\n    </SafeAreaView>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\add-supply.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'fetching' is assigned a value but never used.",
                "line": 24,
                "column": 12,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 24,
                "endColumn": 20
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchSupplyDetails'. Either include it or remove the dependency array.",
                "line": 30,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 30,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [fetchSupplyDetails, id]",
                        "fix": {
                            "range": [
                                1235,
                                1239
                            ],
                            "text": "[fetchSupplyDetails, id]"
                        }
                    }
                ]
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'err' is defined but never used.",
                "line": 49,
                "column": 18,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 49,
                "endColumn": 21
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 3,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from \"@/lib/supabaseClient\";\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, Alert, KeyboardAvoidingView, Platform, ScrollView, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nconst SUPPLY_CATEGORIES = [\r\n    { id: 'seeds', name: 'Seeds', emoji: 'üå±' },\r\n    { id: 'tools', name: 'Tools', emoji: 'üöú' },\r\n    { id: 'fertilizer', name: 'Fertilizer', emoji: 'üß™' },\r\n    { id: 'feed', name: 'Livestock Feed', emoji: 'üåæ' },\r\n];\r\n\r\nexport default function AddSupply() {\r\n    const router = useRouter();\r\n    const { id } = useLocalSearchParams();\r\n    const [name, setName] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [price, setPrice] = useState(\"\");\r\n    const [stock, setStock] = useState(\"\");\r\n    const [category, setCategory] = useState(\"tools\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [fetching, setFetching] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (id) {\r\n            fetchSupplyDetails();\r\n        }\r\n    }, [id]);\r\n\r\n    const fetchSupplyDetails = async () => {\r\n        setFetching(true);\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"supplies\")\r\n                .select(\"*\")\r\n                .eq(\"id\", id)\r\n                .single();\r\n\r\n            if (error) throw error;\r\n            if (data) {\r\n                setName(data.name);\r\n                setDescription(data.description || \"\");\r\n                setPrice(data.price.toString());\r\n                setStock(data.stock.toString());\r\n                setCategory(data.category || \"tools\");\r\n            }\r\n        } catch (err: any) {\r\n            Alert.alert(\"Error\", \"Could not load supply details.\");\r\n            router.back();\r\n        } finally {\r\n            setFetching(false);\r\n        }\r\n    };\r\n\r\n    const handleAddSupply = async () => {\r\n        if (!name.trim() || !price || !stock) {\r\n            Alert.alert(\"Missing Information\", \"Please fill in all required fields (Name, Price, Stock)\");\r\n            return;\r\n        }\r\n\r\n        const priceValue = parseFloat(price);\r\n        const stockValue = parseInt(stock);\r\n\r\n        if (isNaN(priceValue) || priceValue <= 0) {\r\n            Alert.alert(\"Invalid Price\", \"Price must be a valid number greater than 0\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(stockValue) || stockValue < 0) {\r\n            Alert.alert(\"Invalid Stock\", \"Stock must be a valid number (0 or more)\");\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error(\"Not authenticated\");\r\n\r\n            const payload = {\r\n                supplier_id: user.id,\r\n                name: name.trim(),\r\n                description: description.trim() || null,\r\n                price: priceValue,\r\n                stock: stockValue,\r\n                category: category\r\n            };\r\n\r\n            const { error } = id\r\n                ? await supabase.from(\"supplies\").update(payload).eq(\"id\", id)\r\n                : await supabase.from(\"supplies\").insert(payload);\r\n\r\n            if (error) throw error;\r\n\r\n            Alert.alert(\r\n                \"Success! üéâ\",\r\n                `Supply ${id ? 'updated' : 'added'} successfully`,\r\n                [\r\n                    { text: \"OK\", onPress: () => router.back() }\r\n                ]\r\n            );\r\n\r\n        } catch (err: any) {\r\n            console.error(\"Add supply error:\", err);\r\n            Alert.alert(\"Error\", err.message || \"Failed to add supply\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-white\">\r\n            <KeyboardAvoidingView\r\n                behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\r\n                className=\"flex-1\"\r\n            >\r\n                <ScrollView className=\"flex-1 px-6 pt-4\" showsVerticalScrollIndicator={false}>\r\n                    {/* Header */}\r\n                    <View className=\"flex-row items-center mb-6\">\r\n                        <TouchableOpacity onPress={() => router.back()} className=\"mr-4 p-2 bg-gray-100 rounded-full\">\r\n                            <Ionicons name=\"arrow-back\" size={24} color=\"#374151\" />\r\n                        </TouchableOpacity>\r\n                        <Text className=\"text-2xl font-bold text-gray-800\">{id ? 'Edit Supply' : 'Add New Supply'}</Text>\r\n                    </View>\r\n\r\n                    <View className=\"space-y-6\">\r\n                        {/* Name */}\r\n                        <View>\r\n                            <Text className=\"text-sm font-bold text-gray-700 mb-2\">Supply Name *</Text>\r\n                            <View className=\"flex-row items-center border border-gray-200 p-4 rounded-xl bg-gray-50\">\r\n                                <Ionicons name=\"construct-outline\" size={20} color=\"#6b7280\" className=\"mr-2\" />\r\n                                <TextInput\r\n                                    placeholder=\"e.g. Premium Fertilizer, Organic Seeds...\"\r\n                                    value={name}\r\n                                    onChangeText={setName}\r\n                                    className=\"flex-1 text-gray-800 ml-2\"\r\n                                    placeholderTextColor=\"#9CA3AF\"\r\n                                />\r\n                            </View>\r\n                        </View>\r\n\r\n                        {/* Category */}\r\n                        <View>\r\n                            <Text className=\"text-sm font-bold text-gray-700 mb-2\">Category *</Text>\r\n                            <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"flex-row\">\r\n                                {SUPPLY_CATEGORIES.map((cat) => (\r\n                                    <TouchableOpacity\r\n                                        key={cat.id}\r\n                                        onPress={() => setCategory(cat.id)}\r\n                                        className={`px-4 py-2 rounded-full mr-2 flex-row items-center ${category === cat.id ? 'bg-blue-600' : 'bg-gray-100'}`}\r\n                                    >\r\n                                        <Text className=\"mr-1\">{cat.emoji}</Text>\r\n                                        <Text className={`font-medium ${category === cat.id ? 'text-white' : 'text-gray-600'}`}>{cat.name}</Text>\r\n                                    </TouchableOpacity>\r\n                                ))}\r\n                            </ScrollView>\r\n                        </View>\r\n\r\n                        {/* Description */}\r\n                        <View>\r\n                            <Text className=\"text-sm font-bold text-gray-700 mb-2\">Detailed Description</Text>\r\n                            <TextInput\r\n                                placeholder=\"Describe usage, specs, etc...\"\r\n                                value={description}\r\n                                onChangeText={setDescription}\r\n                                multiline\r\n                                numberOfLines={4}\r\n                                textAlignVertical=\"top\"\r\n                                className=\"border border-gray-200 p-4 rounded-xl bg-gray-50 text-gray-800 h-32\"\r\n                                placeholderTextColor=\"#9CA3AF\"\r\n                            />\r\n                        </View>\r\n\r\n                        <View className=\"flex-row space-x-4\">\r\n                            {/* Price */}\r\n                            <View className=\"flex-1\">\r\n                                <Text className=\"text-sm font-bold text-gray-700 mb-2\">Price (DA) *</Text>\r\n                                <View className=\"flex-row items-center border border-gray-200 p-4 rounded-xl bg-gray-50\">\r\n                                    <Text className=\"text-gray-400 font-bold mr-1\">$</Text>\r\n                                    <TextInput\r\n                                        placeholder=\"0.00\"\r\n                                        value={price}\r\n                                        onChangeText={setPrice}\r\n                                        keyboardType=\"numeric\"\r\n                                        className=\"flex-1 text-gray-800\"\r\n                                        placeholderTextColor=\"#9CA3AF\"\r\n                                    />\r\n                                </View>\r\n                            </View>\r\n\r\n                            {/* Stock */}\r\n                            <View className=\"flex-1\">\r\n                                <Text className=\"text-sm font-bold text-gray-700 mb-2\">Initial Stock *</Text>\r\n                                <View className=\"flex-row items-center border border-gray-200 p-4 rounded-xl bg-gray-50\">\r\n                                    <Ionicons name=\"layers-outline\" size={20} color=\"#6b7280\" className=\"mr-2\" />\r\n                                    <TextInput\r\n                                        placeholder=\"0\"\r\n                                        value={stock}\r\n                                        onChangeText={setStock}\r\n                                        keyboardType=\"numeric\"\r\n                                        className=\"flex-1 text-gray-800 ml-2\"\r\n                                        placeholderTextColor=\"#9CA3AF\"\r\n                                    />\r\n                                </View>\r\n                            </View>\r\n                        </View>\r\n                    </View>\r\n\r\n                    {/* Tip Card */}\r\n                    <View className=\"mt-8 bg-blue-50 p-4 rounded-2xl border border-blue-100 flex-row items-center\">\r\n                        <Ionicons name=\"bulb-outline\" size={24} color=\"#2563eb\" />\r\n                        <Text className=\"text-blue-700 text-xs ml-3 flex-1\">\r\n                            Farmers are more likely to buy supplies with clear descriptions and competitive pricing.\r\n                        </Text>\r\n                    </View>\r\n\r\n                    {/* Action Button */}\r\n                    <TouchableOpacity\r\n                        onPress={handleAddSupply}\r\n                        disabled={loading}\r\n                        className={`mt-8 mb-10 py-4 rounded-xl items-center shadow-lg ${loading ? 'bg-blue-400' : 'bg-blue-600'}`}\r\n                    >\r\n                        {loading ? (\r\n                            <ActivityIndicator color=\"#fff\" />\r\n                        ) : (\r\n                            <Text className=\"text-white font-bold text-lg\">{id ? 'Save Changes' : 'Inventory Supply'}</Text>\r\n                        )}\r\n                    </TouchableOpacity>\r\n                </ScrollView>\r\n            </KeyboardAvoidingView>\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\cart.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\edit-profile.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\farmer-profile.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchFarmerData'. Either include it or remove the dependency array.",
                "line": 21,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 21,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [fetchFarmerData, id]",
                        "fix": {
                            "range": [
                                790,
                                794
                            ],
                            "text": "[fetchFarmerData, id]"
                        }
                    }
                ]
            },
            {
                "ruleId": "react/no-unescaped-entities",
                "severity": 2,
                "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
                "line": 85,
                "column": 78,
                "nodeType": "JSXText",
                "messageId": "unescapedEntityAlts",
                "suggestions": [
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&quot;"
                        },
                        "fix": {
                            "range": [
                                3532,
                                3533
                            ],
                            "text": "&quot;"
                        },
                        "desc": "Replace with `&quot;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&ldquo;"
                        },
                        "fix": {
                            "range": [
                                3532,
                                3533
                            ],
                            "text": "&ldquo;"
                        },
                        "desc": "Replace with `&ldquo;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&#34;"
                        },
                        "fix": {
                            "range": [
                                3532,
                                3533
                            ],
                            "text": "&#34;"
                        },
                        "desc": "Replace with `&#34;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&rdquo;"
                        },
                        "fix": {
                            "range": [
                                3532,
                                3533
                            ],
                            "text": "&rdquo;"
                        },
                        "desc": "Replace with `&rdquo;`."
                    }
                ]
            },
            {
                "ruleId": "react/no-unescaped-entities",
                "severity": 2,
                "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
                "line": 85,
                "column": 104,
                "nodeType": "JSXText",
                "messageId": "unescapedEntityAlts",
                "suggestions": [
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&quot;"
                        },
                        "fix": {
                            "range": [
                                3558,
                                3559
                            ],
                            "text": "&quot;"
                        },
                        "desc": "Replace with `&quot;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&ldquo;"
                        },
                        "fix": {
                            "range": [
                                3558,
                                3559
                            ],
                            "text": "&ldquo;"
                        },
                        "desc": "Replace with `&ldquo;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&#34;"
                        },
                        "fix": {
                            "range": [
                                3558,
                                3559
                            ],
                            "text": "&#34;"
                        },
                        "desc": "Replace with `&#34;`."
                    },
                    {
                        "messageId": "replaceWithAlt",
                        "data": {
                            "alt": "&rdquo;"
                        },
                        "fix": {
                            "range": [
                                3558,
                                3559
                            ],
                            "text": "&rdquo;"
                        },
                        "desc": "Replace with `&rdquo;`."
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 2,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, FlatList, Text, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function FarmerProfile() {\r\n    const { id } = useLocalSearchParams();\r\n    const router = useRouter();\r\n\r\n    const [farmer, setFarmer] = useState<any>(null);\r\n    const [products, setProducts] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (id) {\r\n            fetchFarmerData();\r\n        }\r\n    }, [id]);\r\n\r\n    const fetchFarmerData = async () => {\r\n        try {\r\n            // 1. Get Profile\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', id)\r\n                .single();\r\n            setFarmer(profile);\r\n\r\n            // 2. Get Products\r\n            const { data: productsData } = await supabase\r\n                .from('products')\r\n                .select('*')\r\n                .eq('farmer_id', id)\r\n                .eq('is_available', true);\r\n            setProducts(productsData || []);\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n                <ActivityIndicator size=\"large\" color=\"#16a34a\" />\r\n            </SafeAreaView>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-gray-50\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"px-6 py-4 bg-white border-b border-gray-100 flex-row items-center\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\r\n                    <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                </TouchableOpacity>\r\n                <Text className=\"text-xl font-bold text-gray-800\">Farmer Store</Text>\r\n            </View>\r\n\r\n            <FlatList\r\n                data={products}\r\n                keyExtractor={(item) => item.id}\r\n                ListHeaderComponent={() => (\r\n                    <View className=\"bg-white px-6 py-6 mb-4 border-b border-gray-100\">\r\n                        <View className=\"flex-row items-center mb-4\">\r\n                            <View className=\"w-16 h-16 bg-green-100 rounded-full items-center justify-center mr-4\">\r\n                                <Text className=\"text-3xl\">üë®‚Äçüåæ</Text>\r\n                            </View>\r\n                            <View>\r\n                                <Text className=\"text-2xl font-bold text-gray-900\">{farmer?.full_name}</Text>\r\n                                <View className=\"flex-row items-center\">\r\n                                    <Ionicons name=\"location-outline\" size={14} color=\"#6b7280\" />\r\n                                    <Text className=\"text-gray-500 text-sm ml-1\">{farmer?.location || 'Local Farm'}</Text>\r\n                                </View>\r\n                            </View>\r\n                        </View>\r\n                        {farmer?.farm_description && (\r\n                            <Text className=\"text-gray-600 leading-6 italic\">\"{farmer.farm_description}\"</Text>\r\n                        )}\r\n                    </View>\r\n                )}\r\n                renderItem={({ item }) => (\r\n                    <TouchableOpacity\r\n                        className=\"bg-white mx-6 mb-3 p-4 rounded-2xl border border-gray-100 shadow-sm flex-row items-center\"\r\n                        onPress={() => router.push({ pathname: \"/product-details\", params: { id: item.id } })}\r\n                    >\r\n                        <View className=\"w-12 h-12 bg-green-50 rounded-xl items-center justify-center mr-4\">\r\n                            <Text className=\"text-2xl\">üì¶</Text>\r\n                        </View>\r\n                        <View className=\"flex-1\">\r\n                            <Text className=\"font-bold text-gray-800 text-base\">{item.name}</Text>\r\n                            <Text className=\"text-gray-500 text-sm\">{item.category}</Text>\r\n                        </View>\r\n                        <Text className=\"text-green-700 font-bold text-lg\">${item.price}</Text>\r\n                    </TouchableOpacity>\r\n                )}\r\n                ListEmptyComponent={() => (\r\n                    <View className=\"p-20 items-center\">\r\n                        <Text className=\"text-gray-400 italic\">No products currently listed.</Text>\r\n                    </View>\r\n                )}\r\n                contentContainerStyle={{ paddingBottom: 40 }}\r\n            />\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\index.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'checkSession'. Either include it or remove the dependency array.",
                "line": 43,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 43,
                "endColumn": 8,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [checkSession]",
                        "fix": {
                            "range": [
                                1187,
                                1189
                            ],
                            "text": "[checkSession]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useRouter } from \"expo-router\";\nimport { StatusBar } from \"expo-status-bar\";\nimport { useEffect, useState } from \"react\";\nimport {\n  ActivityIndicator,\n  Alert,\n  ImageBackground,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport { SafeAreaView } from \"react-native-safe-area-context\";\n\ntype UserType = 'farmer' | 'buyer' | 'supplier';\n\ninterface User {\n  id: string;\n  full_name: string;\n  role: UserType;\n  email: string;\n  phone?: string;\n}\n\nexport default function EntryScreen() {\n  const router = useRouter();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [checkingSession, setCheckingSession] = useState(true);\n  const [showPassword, setShowPassword] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n\n  useEffect(() => {\n    checkSession();\n  }, []);\n\n  const checkSession = async () => {\n    try {\n      console.log('[EntryScreen] Checking session...');\n      const isLoggingOut = await AsyncStorage.getItem('logging_out');\n\n      if (isLoggingOut === 'true') {\n        console.log('[EntryScreen] üõ°Ô∏è Logout Flag detected! Staying on login page.');\n        await AsyncStorage.removeItem('logging_out');\n        await supabase.auth.signOut();\n        await AsyncStorage.removeItem('user_session');\n        setCheckingSession(false);\n        return;\n      }\n\n      // Petit d√©lai pour √©viter les faux positifs de Supabase\n      await new Promise(resolve => setTimeout(resolve, 800));\n\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session) {\n        console.log('[EntryScreen] ‚úÖ Session found, redirecting to app...');\n        router.replace(\"/(tabs)\");\n      } else {\n        console.log('[EntryScreen] ‚ÑπÔ∏è No session found.');\n      }\n    } catch (e) {\n      console.log('[EntryScreen] Session check error:', e);\n    } finally {\n      setCheckingSession(false);\n    }\n  };\n\n  const validateEmail = (email: string) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n\n  const validateForm = (): { valid: boolean; error?: string } => {\n    if (!email.trim()) {\n      return { valid: false, error: \"Please enter your email\" };\n    }\n    if (!validateEmail(email.trim())) {\n      return { valid: false, error: \"Please enter a valid email address\" };\n    }\n    if (!password) {\n      return { valid: false, error: \"Please enter your password\" };\n    }\n    return { valid: true };\n  };\n\n  const saveUserSession = async (user: User) => {\n    try {\n      await AsyncStorage.setItem('user_session', JSON.stringify({\n        id: user.id,\n        email: user.email,\n        full_name: user.full_name,\n        role: user.role,\n        phone: user.phone,\n        timestamp: new Date().toISOString(),\n      }));\n\n      if (rememberMe) {\n        await AsyncStorage.setItem('remember_email', email.trim().toLowerCase());\n      } else {\n        await AsyncStorage.removeItem('remember_email');\n      }\n    } catch (error) {\n      console.error('Error saving session:', error);\n    }\n  };\n\n  const handleLogin = async () => {\n    const validation = validateForm();\n    if (!validation.valid) {\n      Alert.alert(\"Validation Error\", validation.error);\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const { data: authData, error: authError } = await supabase.auth.signInWithPassword({\n        email: email.trim().toLowerCase(),\n        password: password,\n      });\n\n      if (authError) throw authError;\n      if (!authData.user) throw new Error(\"No user data returned from login\");\n\n      const { data: profile, error: profileError } = await supabase\n        .from(\"profiles\")\n        .select(\"full_name, role, phone\")\n        .eq(\"id\", authData.user.id)\n        .single();\n\n      if (profileError) throw new Error(\"Failed to fetch user profile.\");\n      if (!profile) throw new Error(\"User profile not found.\");\n\n      await saveUserSession({\n        id: authData.user.id,\n        full_name: profile.full_name,\n        email: authData.user.email || email,\n        role: profile.role as UserType,\n        phone: profile.phone,\n      });\n\n      router.replace(\"/(tabs)\");\n\n    } catch (err: any) {\n      Alert.alert(\"Login Failed\", err.message || \"An error occurred. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleForgotPassword = () => {\n    if (!email.trim() || !validateEmail(email.trim())) {\n      Alert.alert(\"Error\", \"Please enter a valid email address first.\");\n      return;\n    }\n    Alert.alert(\"Reset Password\", \"Check your email for instructions.\");\n  };\n\n  if (checkingSession) {\n    return (\n      <View className=\"flex-1 bg-[#166534] justify-center items-center\">\n        <ActivityIndicator size=\"large\" color=\"white\" />\n      </View>\n    );\n  }\n\n  return (\n    <View className=\"flex-1\">\n      <StatusBar style=\"light\" />\n      <ImageBackground\n        source={require('../assets/images/background.png')}\n        className=\"flex-1\"\n        resizeMode=\"cover\"\n      >\n        <LinearGradient\n          colors={['rgba(0,0,0,0.2)', 'rgba(0,0,0,0.5)', 'rgba(0,0,0,0.9)']}\n          className=\"absolute inset-0\"\n        />\n\n        <SafeAreaView className=\"flex-1\">\n          <KeyboardAvoidingView\n            behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\n            className=\"flex-1\"\n          >\n            <ScrollView\n              className=\"flex-1\"\n              contentContainerStyle={{ flexGrow: 1 }}\n              showsVerticalScrollIndicator={false}\n              keyboardShouldPersistTaps=\"handled\"\n            >\n              <View className=\"px-6 flex-1 justify-center py-10\">\n                {/* Brand Header */}\n                <View className=\"items-center mb-10\">\n                  <View className=\"bg-green-500/30 p-5 rounded-full mb-4 backdrop-blur-lg border border-white/20\">\n                    <Ionicons name=\"leaf\" size={48} color=\"white\" />\n                  </View>\n                  <Text className=\"text-white text-5xl font-extrabold tracking-tighter\">\n                    AgriConnect\n                  </Text>\n                  <Text className=\"text-gray-200 text-lg opacity-80 mt-1\">\n                    Your Farm, Connected.\n                  </Text>\n                </View>\n\n                {/* Glassmorphism Card */}\n                <View className=\"bg-white/10 p-6 rounded-[40px] border border-white/20 backdrop-blur-xl shadow-2xl\">\n                  <Text className=\"text-white text-2xl font-bold mb-6 text-center\">Sign In</Text>\n\n                  <View className=\"space-y-4\">\n                    {/* Email Input */}\n                    <View className=\"flex-row items-center bg-white/10 rounded-2xl px-4 py-1 border border-white/10 mb-4\">\n                      <Ionicons name=\"mail\" size={20} color=\"#cbd5e1\" />\n                      <TextInput\n                        placeholder=\"Email Address\"\n                        placeholderTextColor=\"#94a3b8\"\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\n                        value={email}\n                        onChangeText={setEmail}\n                        autoCapitalize=\"none\"\n                        keyboardType=\"email-address\"\n                        editable={!loading}\n                      />\n                    </View>\n\n                    {/* Password Input */}\n                    <View className=\"flex-row items-center bg-white/10 rounded-2xl px-4 py-1 border border-white/10\">\n                      <Ionicons name=\"lock-closed\" size={20} color=\"#cbd5e1\" />\n                      <TextInput\n                        placeholder=\"Password\"\n                        placeholderTextColor=\"#94a3b8\"\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\n                        secureTextEntry={!showPassword}\n                        value={password}\n                        onChangeText={setPassword}\n                        editable={!loading}\n                      />\n                      <TouchableOpacity onPress={() => setShowPassword(!showPassword)}>\n                        <Ionicons name={showPassword ? \"eye-off\" : \"eye\"} size={22} color=\"#cbd5e1\" />\n                      </TouchableOpacity>\n                    </View>\n\n                    {/* Options Row */}\n                    <View className=\"flex-row justify-between items-center px-1 mt-4\">\n                      <TouchableOpacity\n                        onPress={() => setRememberMe(!rememberMe)}\n                        className=\"flex-row items-center\"\n                      >\n                        <View className={`w-5 h-5 rounded-md border border-white/30 mr-2 items-center justify-center ${rememberMe ? 'bg-green-500 border-green-500' : ''}`}>\n                          {rememberMe && <Ionicons name=\"checkmark\" size={14} color=\"white\" />}\n                        </View>\n                        <Text className=\"text-gray-300 text-sm\">Remember me</Text>\n                      </TouchableOpacity>\n\n                      <TouchableOpacity onPress={handleForgotPassword}>\n                        <Text className=\"text-green-400 text-sm font-bold\">Forgot Password?</Text>\n                      </TouchableOpacity>\n                    </View>\n\n                    {/* Action Button */}\n                    <TouchableOpacity\n                      onPress={handleLogin}\n                      disabled={loading}\n                      activeOpacity={0.9}\n                      className={`mt-8 py-4 rounded-2xl flex-row justify-center items-center shadow-xl shadow-green-900/50 ${loading ? 'bg-green-600/50' : 'bg-green-600'}`}\n                    >\n                      {loading ? (\n                        <ActivityIndicator color=\"white\" />\n                      ) : (\n                        <>\n                          <Text className=\"text-white font-bold text-lg mr-2\">Sign In</Text>\n                          <Ionicons name=\"arrow-forward\" size={20} color=\"white\" />\n                        </>\n                      )}\n                    </TouchableOpacity>\n                  </View>\n                </View>\n\n                {/* Footer Actions */}\n                <View className=\"flex-row justify-center mt-10\">\n                  <Text className=\"text-gray-300\">New here? </Text>\n                  <TouchableOpacity onPress={() => router.push(\"/signup\")}>\n                    <Text className=\"text-green-500 font-bold underline\">Create Account</Text>\n                  </TouchableOpacity>\n                </View>\n              </View>\n            </ScrollView>\n          </KeyboardAvoidingView>\n        </SafeAreaView>\n      </ImageBackground>\n    </View>\n  );\n}",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\my-products.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\product-details.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has missing dependencies: 'checkIfFavorite', 'fetchProduct', and 'fetchReviews'. Either include them or remove the dependency array.",
                "line": 29,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 29,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [checkIfFavorite, fetchProduct, fetchReviews, id]",
                        "fix": {
                            "range": [
                                1200,
                                1204
                            ],
                            "text": "[checkIfFavorite, fetchProduct, fetchReviews, id]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, Alert, Linking, ScrollView, Text, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function ProductDetails() {\r\n    const { id } = useLocalSearchParams();\r\n    const router = useRouter();\r\n\r\n    const [product, setProduct] = useState<any>(null);\r\n    const [reviews, setReviews] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [purchasing, setPurchasing] = useState(false);\r\n    const [currentUser, setCurrentUser] = useState<any>(null);\r\n    const [buyQuantity, setBuyQuantity] = useState(1);\r\n    const [isFavorite, setIsFavorite] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (id) {\r\n            fetchProduct();\r\n            fetchReviews();\r\n            checkUser();\r\n            checkIfFavorite();\r\n        }\r\n    }, [id]);\r\n\r\n    const checkIfFavorite = async () => {\r\n        try {\r\n            const favoritesStr = await AsyncStorage.getItem('wishlist');\r\n            if (favoritesStr) {\r\n                const favorites = JSON.parse(favoritesStr);\r\n                setIsFavorite(favorites.includes(id));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error checking favorite:\", error);\r\n        }\r\n    };\r\n\r\n    const toggleFavorite = async () => {\r\n        try {\r\n            const favoritesStr = await AsyncStorage.getItem('wishlist') || '[]';\r\n            let favorites = JSON.parse(favoritesStr);\r\n\r\n            if (isFavorite) {\r\n                favorites = favorites.filter((favId: string) => favId !== id);\r\n            } else {\r\n                favorites.push(id);\r\n            }\r\n\r\n            await AsyncStorage.setItem('wishlist', JSON.stringify(favorites));\r\n            setIsFavorite(!isFavorite);\r\n        } catch (error) {\r\n            console.error(\"Error toggling favorite:\", error);\r\n        }\r\n    };\r\n\r\n    const handleCall = () => {\r\n        if (product?.farmer?.phone) {\r\n            Linking.openURL(`tel:${product.farmer.phone}`);\r\n        } else {\r\n            Alert.alert(\"Notice\", \"Farmer phone number not available.\");\r\n        }\r\n    };\r\n\r\n    const checkUser = async () => {\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        setCurrentUser(user);\r\n    };\r\n\r\n    const fetchProduct = async () => {\r\n        if (!id) return;\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('products')\r\n                .select('id, name, description, price, stock, category, farmer_id')\r\n                .eq('id', id)\r\n                .single();\r\n\r\n            if (error) throw error;\r\n\r\n            let productData: any = data;\r\n\r\n            // Manual fetch for farmer details since FK might be missing\r\n            if (data.farmer_id) {\r\n                const { data: farmerData } = await supabase\r\n                    .from('profiles')\r\n                    .select('id, full_name, role, phone') // Added phone\r\n                    .eq('id', data.farmer_id)\r\n                    .single();\r\n\r\n                if (farmerData) {\r\n                    productData = { ...productData, farmer: farmerData };\r\n                }\r\n            }\r\n\r\n            setProduct(productData);\r\n            addToRecent(productData.id);\r\n        } catch (error) {\r\n            console.error(error);\r\n            Alert.alert(\"Error\", \"Failed to load product details\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const addToRecent = async (productId: string) => {\r\n        try {\r\n            const history = await AsyncStorage.getItem('recent_views');\r\n            let ids = history ? JSON.parse(history) : [];\r\n            // Remove if exists to move to top\r\n            ids = ids.filter((id: string) => id !== productId);\r\n            // Add to front\r\n            ids.unshift(productId);\r\n            // Limit to 5\r\n            ids = ids.slice(0, 5);\r\n            await AsyncStorage.setItem('recent_views', JSON.stringify(ids));\r\n        } catch (e) {\r\n            console.log('Error saving recent view', e);\r\n        }\r\n    };\r\n\r\n    const fetchReviews = async () => {\r\n        if (!id) return;\r\n        const { data, error } = await supabase\r\n            .from('reviews')\r\n            .select(`\r\n                id, rating, comment, created_at,\r\n                buyer:profiles(full_name)\r\n            `)\r\n            .eq('product_id', id)\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (!error && data) {\r\n            setReviews(data);\r\n        }\r\n    };\r\n\r\n    const handleAddToCart = async () => {\r\n        try {\r\n            const cartStr = await AsyncStorage.getItem('cart') || '[]';\r\n            const cart = JSON.parse(cartStr);\r\n\r\n            const existingItem = cart.find((item: any) => item.id === product.id);\r\n            if (existingItem) {\r\n                existingItem.quantity += buyQuantity;\r\n            } else {\r\n                cart.push({\r\n                    id: product.id,\r\n                    name: product.name,\r\n                    price: product.price,\r\n                    quantity: buyQuantity,\r\n                    farmer_id: product.farmer_id,\r\n                    category: product.category\r\n                });\r\n            }\r\n\r\n            await AsyncStorage.setItem('cart', JSON.stringify(cart));\r\n            Alert.alert(\"Success\", \"Added to cart!\", [\r\n                { text: \"View Cart\", onPress: () => router.push(\"/cart\") },\r\n                { text: \"Continue\" }\r\n            ]);\r\n        } catch (error) {\r\n            console.error(\"Cart error:\", error);\r\n            Alert.alert(\"Error\", \"Could not add to cart.\");\r\n        }\r\n    };\r\n\r\n    const handleBuy = async () => {\r\n        if (!currentUser) {\r\n            Alert.alert(\"Login Required\", \"You must be logged in to purchase items.\", [\r\n                { text: \"Cancel\" },\r\n                { text: \"Login\", onPress: () => router.replace(\"/\") }\r\n            ]);\r\n            return;\r\n        }\r\n\r\n        if (product.farmer.id === currentUser.id) {\r\n            Alert.alert(\"Error\", \"You cannot buy your own product!\");\r\n            return;\r\n        }\r\n\r\n        const totalPrice = (product.price * buyQuantity).toFixed(2);\r\n\r\n        Alert.alert(\r\n            \"Confirm Purchase\",\r\n            `Buy ${buyQuantity}x ${product.name} for $${totalPrice}?`,\r\n            [\r\n                { text: \"Cancel\", style: \"cancel\" },\r\n                { text: \"Buy Now\", onPress: processPurchase }\r\n            ]\r\n        );\r\n    };\r\n\r\n    const processPurchase = async () => {\r\n        setPurchasing(true);\r\n        try {\r\n            const totalPrice = product.price * buyQuantity;\r\n\r\n            // 1. Create Order Header\r\n            const { data: order, error: orderError } = await supabase\r\n                .from('orders')\r\n                .insert({\r\n                    buyer_id: currentUser.id,\r\n                    farmer_id: product.farmer_id,\r\n                    status: 'pending',\r\n                    total_amount: totalPrice\r\n                })\r\n                .select()\r\n                .single();\r\n\r\n            if (orderError) throw orderError;\r\n\r\n            // 2. Create Order Item\r\n            const { error: itemError } = await supabase\r\n                .from('order_items')\r\n                .insert({\r\n                    order_id: order.id,\r\n                    product_id: product.id,\r\n                    quantity: buyQuantity,\r\n                    price: product.price\r\n                });\r\n\r\n            if (itemError) {\r\n                // Determine if we should rollback order - simplified: just throw\r\n                throw itemError;\r\n            }\r\n\r\n            // 3. Update Stock\r\n            const { error: stockError } = await supabase\r\n                .from('products')\r\n                .update({ stock: product.stock - buyQuantity })\r\n                .eq('id', product.id);\r\n\r\n            if (stockError) console.error(\"Stock update error (non-fatal):\", stockError);\r\n\r\n            Alert.alert(\"Success!\", \"Order placed successfully!\", [\r\n                { text: \"View Orders\", onPress: () => router.replace(\"/(tabs)/orders\" as any) },\r\n                { text: \"Continue Shopping\", onPress: () => router.back() }\r\n            ]);\r\n\r\n        } catch (error: any) {\r\n            console.error(error);\r\n            Alert.alert(\"Purchase Failed\", error.message);\r\n        } finally {\r\n            setPurchasing(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n                <ActivityIndicator size=\"large\" color=\"#16a34a\" />\r\n            </SafeAreaView>\r\n        );\r\n    }\r\n\r\n    if (!product) {\r\n        return (\r\n            <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n                <Text>Product not found</Text>\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mt-4\">\r\n                    <Text className=\"text-blue-600\">Go Back</Text>\r\n                </TouchableOpacity>\r\n            </SafeAreaView>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-white\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"flex-row items-center px-4 py-2 border-b border-gray-100\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"p-2 bg-gray-50 rounded-full mr-4\">\r\n                    <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                </TouchableOpacity>\r\n                <Text className=\"text-lg font-bold text-gray-800 flex-1\" numberOfLines={1}>\r\n                    {product.name}\r\n                </Text>\r\n            </View>\r\n\r\n            <ScrollView className=\"flex-1\" contentContainerStyle={{ paddingBottom: 100 }}>\r\n                {/* Product Info */}\r\n                <View className=\"p-6\">\r\n                    <View className=\"flex-row justify-between items-start mb-4\">\r\n                        <View className=\"flex-1 mr-4\">\r\n                            <Text className=\"text-3xl font-bold text-gray-900 mb-1\">{product.name}</Text>\r\n                            <Text className=\"text-gray-500\">Stock: {product.stock}</Text>\r\n                        </View>\r\n                        <View className=\"flex-row items-center\">\r\n                            <Text className=\"text-2xl font-bold text-green-700 mr-4\">\r\n                                ${product.price}\r\n                            </Text>\r\n                            <TouchableOpacity\r\n                                onPress={toggleFavorite}\r\n                                className={`p-3 rounded-full ${isFavorite ? 'bg-red-50' : 'bg-gray-50'}`}\r\n                            >\r\n                                <Ionicons\r\n                                    name={isFavorite ? \"heart\" : \"heart-outline\"}\r\n                                    size={28}\r\n                                    color={isFavorite ? \"#ef4444\" : \"#6b7280\"}\r\n                                />\r\n                            </TouchableOpacity>\r\n                        </View>\r\n                    </View>\r\n\r\n                    <Text className=\"text-lg font-bold text-gray-800 mb-2\">Description</Text>\r\n                    <Text className=\"text-gray-600 leading-6 mb-6\">\r\n                        {product.description || \"No description available.\"}\r\n                    </Text>\r\n\r\n                    {/* Farmer/Seller Info */}\r\n                    <TouchableOpacity\r\n                        onPress={() => router.push({ pathname: \"/farmer-profile\", params: { id: product.farmer_id } })}\r\n                        className=\"flex-row items-center bg-green-50 p-4 rounded-xl mb-6\"\r\n                    >\r\n                        <View className=\"w-10 h-10 bg-green-200 rounded-full items-center justify-center mr-3\">\r\n                            <Text className=\"text-lg\">üë®‚Äçüåæ</Text>\r\n                        </View>\r\n                        <View className=\"flex-1\">\r\n                            <Text className=\"font-bold text-gray-800\">Sold by {product.farmer?.full_name}</Text>\r\n                            <Text className=\"text-green-600 text-xs font-medium\">View Store ‚Üí</Text>\r\n                        </View>\r\n                        <TouchableOpacity\r\n                            onPress={handleCall}\r\n                            className=\"bg-white p-2 rounded-full shadow-sm\"\r\n                        >\r\n                            <Ionicons name=\"call\" size={20} color=\"#16a34a\" />\r\n                        </TouchableOpacity>\r\n                    </TouchableOpacity>\r\n\r\n                    {/* Reviews Section */}\r\n                    <View className=\"mt-4\">\r\n                        <Text className=\"text-xl font-bold text-gray-800 mb-4\">Reviews ({reviews.length})</Text>\r\n                        {reviews.length > 0 ? (\r\n                            reviews.map((review) => (\r\n                                <View key={review.id} className=\"bg-gray-50 p-4 rounded-xl mb-3\">\r\n                                    <View className=\"flex-row justify-between mb-2\">\r\n                                        <Text className=\"font-bold text-gray-700\">{review.buyer?.full_name || 'Anonymous'}</Text>\r\n                                        <Text className=\"text-yellow-500\">{'‚≠ê'.repeat(review.rating)}</Text>\r\n                                    </View>\r\n                                    <Text className=\"text-gray-600\">{review.comment}</Text>\r\n                                </View>\r\n                            ))\r\n                        ) : (\r\n                            <Text className=\"text-gray-500 italic\">No reviews yet.</Text>\r\n                        )}\r\n                    </View>\r\n                </View>\r\n            </ScrollView>\r\n\r\n            {/* Footer Action */}\r\n            <View className=\"absolute bottom-0 w-full bg-white border-t border-gray-100 p-6 shadow-lg\">\r\n                <View className=\"flex-row items-center justify-between mb-4\">\r\n                    <Text className=\"font-semibold text-gray-700\">Quantity</Text>\r\n                    <View className=\"flex-row items-center space-x-4 bg-gray-100 rounded-lg p-1\">\r\n                        <TouchableOpacity\r\n                            onPress={() => setBuyQuantity(Math.max(1, buyQuantity - 1))}\r\n                            className=\"w-8 h-8 items-center justify-center bg-white rounded shadow-sm\"\r\n                        >\r\n                            <Text className=\"text-lg font-bold\">-</Text>\r\n                        </TouchableOpacity>\r\n                        <Text className=\"font-bold text-lg w-8 text-center\">{buyQuantity}</Text>\r\n                        <TouchableOpacity\r\n                            onPress={() => setBuyQuantity(Math.min(product.stock, buyQuantity + 1))}\r\n                            className=\"w-8 h-8 items-center justify-center bg-white rounded shadow-sm\"\r\n                        >\r\n                            <Text className=\"text-lg font-bold\">+</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </View>\r\n\r\n                <View className=\"flex-row space-x-4\">\r\n                    <TouchableOpacity\r\n                        className=\"flex-1 py-4 rounded-xl border border-green-600 flex-row justify-center items-center bg-white\"\r\n                        onPress={handleAddToCart}\r\n                        disabled={product.stock <= 0 || purchasing}\r\n                    >\r\n                        <Ionicons name=\"cart-outline\" size={20} color=\"#16a34a\" />\r\n                        <Text className=\"text-green-600 font-bold text-lg ml-2\">Add to Cart</Text>\r\n                    </TouchableOpacity>\r\n\r\n                    <TouchableOpacity\r\n                        className={`flex-1 py-4 rounded-xl flex-row justify-center items-center ${product.stock > 0 ? 'bg-green-600' : 'bg-gray-400'}`}\r\n                        onPress={handleBuy}\r\n                        disabled={product.stock <= 0 || purchasing}\r\n                    >\r\n                        {purchasing ? (\r\n                            <ActivityIndicator color=\"white\" />\r\n                        ) : (\r\n                            <Text className=\"text-white font-bold text-lg\">\r\n                                {product.stock > 0 ? 'Buy Now' : 'Out of Stock'}\r\n                            </Text>\r\n                        )}\r\n                    </TouchableOpacity>\r\n                </View>\r\n            </View>\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\signup.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'setPhone' is assigned a value but never used.",
                "line": 33,
                "column": 17,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 33,
                "endColumn": 25
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { LinearGradient } from 'expo-linear-gradient';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport React, { useState } from \"react\";\r\nimport {\r\n  ActivityIndicator,\r\n  Alert,\r\n  ImageBackground,\r\n  KeyboardAvoidingView,\r\n  Platform,\r\n  ScrollView,\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n} from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\ntype UserRole = \"farmer\" | \"buyer\" | \"supplier\";\r\n\r\ninterface ValidationResult {\r\n  valid: boolean;\r\n  error?: string;\r\n}\r\n\r\nexport default function Signup() {\r\n  const router = useRouter();\r\n  const [role, setRole] = useState<UserRole>(\"farmer\");\r\n  const [fullName, setFullName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n\r\n  const validateEmail = (email: string): boolean => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const validatePassword = (password: string): ValidationResult => {\r\n    if (password.length < 8) {\r\n      return { valid: false, error: \"Password must be at least 8 characters\" };\r\n    }\r\n    if (!/[A-Z]/.test(password)) {\r\n      return { valid: false, error: \"Password must contain at least one uppercase letter\" };\r\n    }\r\n    if (!/[0-9]/.test(password)) {\r\n      return { valid: false, error: \"Password must contain at least one number\" };\r\n    }\r\n    return { valid: true };\r\n  };\r\n\r\n  const validatePhone = (phone: string): boolean => {\r\n    if (!phone.trim()) return true;\r\n    const phoneRegex = /^[\\d\\s\\-\\+\\(\\)]{10,}$/;\r\n    return phoneRegex.test(phone);\r\n  };\r\n\r\n  const validateForm = (): ValidationResult => {\r\n    if (!fullName.trim()) return { valid: false, error: \"Please enter your full name\" };\r\n    if (fullName.trim().length < 2) return { valid: false, error: \"Name must be at least 2 characters\" };\r\n    if (!email.trim()) return { valid: false, error: \"Please enter your email\" };\r\n    if (!validateEmail(email.trim())) return { valid: false, error: \"Please enter a valid email address\" };\r\n    if (phone.trim() && !validatePhone(phone)) return { valid: false, error: \"Please enter a valid phone number\" };\r\n    if (!password) return { valid: false, error: \"Please enter a password\" };\r\n\r\n    const passwordValidation = validatePassword(password);\r\n    if (!passwordValidation.valid) return passwordValidation;\r\n\r\n    if (password !== confirmPassword) return { valid: false, error: \"Passwords do not match\" };\r\n\r\n    return { valid: true };\r\n  };\r\n\r\n  const handleSignup = async () => {\r\n    const validation = validateForm();\r\n    if (!validation.valid) {\r\n      Alert.alert(\"Validation Error\", validation.error);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const { data: authData, error: authError } = await supabase.auth.signUp({\r\n        email: email.trim().toLowerCase(),\r\n        password: password,\r\n      });\r\n\r\n      if (authError) throw authError;\r\n      if (!authData.user) throw new Error(\"No user data returned from signup\");\r\n\r\n      const { error: profileError } = await supabase\r\n        .from(\"profiles\")\r\n        .upsert({\r\n          id: authData.user.id,\r\n          full_name: fullName.trim(),\r\n          role: role,\r\n          phone: phone.trim() || null,\r\n          updated_at: new Date().toISOString(),\r\n        });\r\n\r\n      if (profileError) throw profileError;\r\n\r\n      Alert.alert(\r\n        \"Welcome to the Family! üéâ\",\r\n        \"Account created successfully. You can now log in.\",\r\n        [{ text: \"Great!\", onPress: () => router.replace(\"/\") }]\r\n      );\r\n\r\n    } catch (err: any) {\r\n      Alert.alert(\"Signup Failed\", err.message || \"Something went wrong.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getRoleInfo = (roleType: UserRole) => {\r\n    const roleConfig = {\r\n      farmer: { emoji: \"üå±\", label: \"Farmer\" },\r\n      buyer: { emoji: \"üõí\", label: \"Buyer\" },\r\n      supplier: { emoji: \"üì¶\", label: \"Supplier\" },\r\n    };\r\n    return roleConfig[roleType];\r\n  };\r\n\r\n  return (\r\n    <View className=\"flex-1\">\r\n      <StatusBar style=\"light\" />\r\n      <ImageBackground\r\n        source={require('../assets/images/signup_bg.png')}\r\n        className=\"flex-1\"\r\n        resizeMode=\"cover\"\r\n      >\r\n        <LinearGradient\r\n          colors={['rgba(0,0,0,0.1)', 'rgba(0,0,0,0.4)', 'rgba(0,0,0,0.9)']}\r\n          className=\"absolute inset-0\"\r\n        />\r\n\r\n        <SafeAreaView className=\"flex-1\">\r\n          <KeyboardAvoidingView\r\n            behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\r\n            className=\"flex-1\"\r\n          >\r\n            <ScrollView\r\n              className=\"flex-1\"\r\n              contentContainerStyle={{ flexGrow: 1 }}\r\n              showsVerticalScrollIndicator={false}\r\n              keyboardShouldPersistTaps=\"handled\"\r\n            >\r\n              {/* Floating Back Button */}\r\n              <TouchableOpacity\r\n                onPress={() => router.replace(\"/\")}\r\n                className=\"mt-4 ml-6 bg-white/20 p-2.5 rounded-full self-start backdrop-blur-md border border-white/30\"\r\n              >\r\n                <Ionicons name=\"arrow-back\" size={24} color=\"white\" />\r\n              </TouchableOpacity>\r\n\r\n              <View className=\"px-6 py-10\">\r\n                <Text className=\"text-white text-5xl font-extrabold tracking-tighter mb-2\">\r\n                  Join Us\r\n                </Text>\r\n                <Text className=\"text-gray-200 text-lg opacity-80 mb-8\">\r\n                  Create your account & join the community.\r\n                </Text>\r\n\r\n                {/* Glass Card */}\r\n                <View className=\"bg-white/10 p-6 rounded-[40px] border border-white/20 backdrop-blur-xl shadow-2xl\">\r\n\r\n                  {/* Role Selector */}\r\n                  <Text className=\"text-white font-bold mb-4 ml-1\">Choose your role</Text>\r\n                  <View className=\"flex-row justify-between mb-8\">\r\n                    {([\"farmer\", \"buyer\", \"supplier\"] as UserRole[]).map((r) => {\r\n                      const roleInfo = getRoleInfo(r);\r\n                      const isSelected = role === r;\r\n                      return (\r\n                        <TouchableOpacity\r\n                          key={r}\r\n                          className={`flex-1 py-4 mx-1 rounded-2xl border ${isSelected ? 'bg-green-600 border-green-500 shadow-xl shadow-green-900/40' : 'bg-white/10 border-white/10'}`}\r\n                          onPress={() => setRole(r)}\r\n                          activeOpacity={0.7}\r\n                        >\r\n                          <Text className=\"text-center text-2xl mb-1\">{roleInfo.emoji}</Text>\r\n                          <Text className={`text-center font-bold text-xs ${isSelected ? 'text-white' : 'text-gray-300'}`}>\r\n                            {roleInfo.label}\r\n                          </Text>\r\n                        </TouchableOpacity>\r\n                      );\r\n                    })}\r\n                  </View>\r\n\r\n                  {/* Form */}\r\n                  <View className=\"space-y-4\">\r\n                    <View className=\"bg-white/10 rounded-2xl flex-row items-center px-4 border border-white/10 mb-4\">\r\n                      <Ionicons name=\"person\" size={20} color=\"#cbd5e1\" />\r\n                      <TextInput\r\n                        placeholder=\"Full Name\"\r\n                        placeholderTextColor=\"#94a3b8\"\r\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\r\n                        value={fullName}\r\n                        onChangeText={setFullName}\r\n                      />\r\n                    </View>\r\n\r\n                    <View className=\"bg-white/10 rounded-2xl flex-row items-center px-4 border border-white/10 mb-4\">\r\n                      <Ionicons name=\"mail\" size={20} color=\"#cbd5e1\" />\r\n                      <TextInput\r\n                        placeholder=\"Email Address\"\r\n                        placeholderTextColor=\"#94a3b8\"\r\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\r\n                        value={email}\r\n                        onChangeText={setEmail}\r\n                        autoCapitalize=\"none\"\r\n                        keyboardType=\"email-address\"\r\n                      />\r\n                    </View>\r\n\r\n                    <View className=\"bg-white/10 rounded-2xl flex-row items-center px-4 border border-white/10 mb-4\">\r\n                      <Ionicons name=\"lock-closed\" size={20} color=\"#cbd5e1\" />\r\n                      <TextInput\r\n                        placeholder=\"Password\"\r\n                        placeholderTextColor=\"#94a3b8\"\r\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\r\n                        secureTextEntry={!showPassword}\r\n                        value={password}\r\n                        onChangeText={setPassword}\r\n                      />\r\n                      <TouchableOpacity onPress={() => setShowPassword(!showPassword)}>\r\n                        <Ionicons name={showPassword ? \"eye-off\" : \"eye\"} size={22} color=\"#cbd5e1\" />\r\n                      </TouchableOpacity>\r\n                    </View>\r\n\r\n                    <View className=\"bg-white/10 rounded-2xl flex-row items-center px-4 border border-white/10\">\r\n                      <Ionicons name=\"lock-closed\" size={20} color=\"#cbd5e1\" />\r\n                      <TextInput\r\n                        placeholder=\"Confirm Password\"\r\n                        placeholderTextColor=\"#94a3b8\"\r\n                        className=\"flex-1 py-4 px-3 text-white font-medium\"\r\n                        secureTextEntry={!showConfirmPassword}\r\n                        value={confirmPassword}\r\n                        onChangeText={setConfirmPassword}\r\n                      />\r\n                      <TouchableOpacity onPress={() => setShowConfirmPassword(!showConfirmPassword)}>\r\n                        <Ionicons name={showConfirmPassword ? \"eye-off\" : \"eye\"} size={22} color=\"#cbd5e1\" />\r\n                      </TouchableOpacity>\r\n                    </View>\r\n\r\n                    {/* Submit Button */}\r\n                    <TouchableOpacity\r\n                      onPress={handleSignup}\r\n                      disabled={loading}\r\n                      activeOpacity={0.8}\r\n                      className={`mt-8 py-4 rounded-2xl flex-row justify-center items-center shadow-lg ${loading ? 'bg-green-600/50' : 'bg-green-600'}`}\r\n                    >\r\n                      {loading ? (\r\n                        <ActivityIndicator color=\"white\" />\r\n                      ) : (\r\n                        <>\r\n                          <Text className=\"text-white font-bold text-lg mr-2\">Create Account</Text>\r\n                          <Ionicons name=\"chevron-forward\" size={20} color=\"white\" />\r\n                        </>\r\n                      )}\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                </View>\r\n\r\n                {/* Footer */}\r\n                <View className=\"flex-row justify-center mt-8 pb-10\">\r\n                  <Text className=\"text-gray-300\">Already a member? </Text>\r\n                  <TouchableOpacity onPress={() => router.replace(\"/\")}>\r\n                    <Text className=\"text-green-500 font-bold underline\">Login</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              </View>\r\n            </ScrollView>\r\n          </KeyboardAvoidingView>\r\n        </SafeAreaView>\r\n      </ImageBackground>\r\n    </View>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\submit-review.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'orderId' is assigned a value but never used.",
                "line": 10,
                "column": 13,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 10,
                "endColumn": 20
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useState } from \"react\";\r\nimport { ActivityIndicator, Alert, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function SubmitReview() {\r\n    const { orderId, productId, productName } = useLocalSearchParams();\r\n    const router = useRouter();\r\n\r\n    const [rating, setRating] = useState(5);\r\n    const [comment, setComment] = useState(\"\");\r\n    const [submitting, setSubmitting] = useState(false);\r\n\r\n    const handleSubmit = async () => {\r\n        if (!comment.trim()) {\r\n            Alert.alert(\"Error\", \"Please provide a brief comment.\");\r\n            return;\r\n        }\r\n\r\n        setSubmitting(true);\r\n        try {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error(\"Not authenticated\");\r\n\r\n            const { error } = await supabase\r\n                .from('reviews')\r\n                .insert({\r\n                    product_id: productId,\r\n                    buyer_id: user.id,\r\n                    rating: rating,\r\n                    comment: comment.trim()\r\n                });\r\n\r\n            if (error) throw error;\r\n\r\n            Alert.alert(\"Success\", \"Thank you for your review!\", [\r\n                { text: \"OK\", onPress: () => router.back() }\r\n            ]);\r\n        } catch (error: any) {\r\n            console.error(error);\r\n            Alert.alert(\"Error\", error.message);\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-white\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"flex-row items-center px-6 py-4 border-b border-gray-100\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\r\n                    <Ionicons name=\"close\" size={28} color=\"black\" />\r\n                </TouchableOpacity>\r\n                <Text className=\"text-xl font-bold text-gray-800\">Submit Review</Text>\r\n            </View>\r\n\r\n            <View className=\"p-6\">\r\n                <Text className=\"text-gray-500 text-sm mb-1\">Product</Text>\r\n                <Text className=\"text-xl font-bold text-gray-900 mb-6\">{productName}</Text>\r\n\r\n                <Text className=\"text-gray-700 font-bold mb-3\">Rating</Text>\r\n                <View className=\"flex-row items-center gap-2 mb-8\">\r\n                    {[1, 2, 3, 4, 5].map((s) => (\r\n                        <TouchableOpacity key={s} onPress={() => setRating(s)}>\r\n                            <Ionicons\r\n                                name={s <= rating ? \"star\" : \"star-outline\"}\r\n                                size={40}\r\n                                color={s <= rating ? \"#eab308\" : \"#d1d5db\"}\r\n                            />\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </View>\r\n\r\n                <Text className=\"text-gray-700 font-bold mb-3\">Your Experience</Text>\r\n                <TextInput\r\n                    className=\"bg-gray-50 rounded-2xl p-4 text-base text-gray-800 border border-gray-100 mb-8\"\r\n                    placeholder=\"Tell us what you liked or how it could be better...\"\r\n                    multiline\r\n                    numberOfLines={4}\r\n                    textAlignVertical=\"top\"\r\n                    value={comment}\r\n                    onChangeText={setComment}\r\n                />\r\n\r\n                <TouchableOpacity\r\n                    className={`w-full py-4 rounded-xl flex-row justify-center items-center ${submitting ? 'bg-gray-400' : 'bg-green-600'}`}\r\n                    onPress={handleSubmit}\r\n                    disabled={submitting}\r\n                >\r\n                    {submitting ? (\r\n                        <ActivityIndicator color=\"white\" />\r\n                    ) : (\r\n                        <Text className=\"text-white font-bold text-lg\">Post Review</Text>\r\n                    )}\r\n                </TouchableOpacity>\r\n            </View>\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\supplier-profile.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'loadProfile'. Either include it or remove the dependency array.",
                "line": 18,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 18,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [id, loadProfile]",
                        "fix": {
                            "range": [
                                754,
                                758
                            ],
                            "text": "[id, loadProfile]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, FlatList, Text, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function SupplierProfile() {\r\n    const { id } = useLocalSearchParams();\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [profile, setProfile] = useState<any>(null);\r\n    const [supplies, setSupplies] = useState<any[]>([]);\r\n\r\n    useEffect(() => {\r\n        loadProfile();\r\n    }, [id]);\r\n\r\n    const loadProfile = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data: profileData, error: profileError } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', id)\r\n                .single();\r\n\r\n            if (profileError) throw profileError;\r\n            setProfile(profileData);\r\n\r\n            const { data: suppliesData } = await supabase\r\n                .from('supplies')\r\n                .select('*')\r\n                .eq('supplier_id', id)\r\n                .order('created_at', { ascending: false });\r\n\r\n            setSupplies(suppliesData || []);\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n                <ActivityIndicator size=\"large\" color=\"#16a34a\" />\r\n            </SafeAreaView>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-gray-50\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"bg-white px-6 py-6 border-b border-gray-100 mb-4\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mb-4\">\r\n                    <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                </TouchableOpacity>\r\n\r\n                <View className=\"flex-row items-center\">\r\n                    <View className=\"w-20 h-20 bg-blue-100 rounded-3xl items-center justify-center mr-4\">\r\n                        <Text className=\"text-3xl text-blue-600 font-bold\">\r\n                            {profile?.full_name?.charAt(0) || 'S'}\r\n                        </Text>\r\n                    </View>\r\n                    <View className=\"flex-1\">\r\n                        <Text className=\"text-2xl font-bold text-gray-900\">{profile?.full_name}</Text>\r\n                        <View className=\"flex-row items-center mt-1\">\r\n                            <Ionicons name=\"location-sharp\" size={14} color=\"#6b7280\" />\r\n                            <Text className=\"text-gray-500 text-sm ml-1\">{profile?.location || 'Local Supplier'}</Text>\r\n                        </View>\r\n                    </View>\r\n                </View>\r\n\r\n                <View className=\"bg-blue-50 mt-6 p-4 rounded-2xl border border-blue-50\">\r\n                    <Text className=\"text-blue-900 font-medium\">Business Info</Text>\r\n                    <Text className=\"text-blue-700 text-sm mt-1\">{profile?.farm_description || profile?.bio || \"Professional agricultural supplier providing high-quality items for local farmers.\"}</Text>\r\n                </View>\r\n            </View>\r\n\r\n            <View className=\"px-6 flex-1\">\r\n                <Text className=\"text-xl font-bold text-gray-900 mb-4\">Available Supplies</Text>\r\n\r\n                <FlatList\r\n                    data={supplies}\r\n                    keyExtractor={(item) => item.id}\r\n                    showsVerticalScrollIndicator={false}\r\n                    renderItem={({ item }) => (\r\n                        <TouchableOpacity\r\n                            onPress={() => router.push({ pathname: \"/supply-details\", params: { id: item.id } })}\r\n                            className=\"bg-white p-4 rounded-2xl mb-4 shadow-sm border border-gray-100 flex-row items-center\"\r\n                        >\r\n                            <View className=\"w-14 h-14 bg-gray-50 rounded-xl items-center justify-center mr-4\">\r\n                                <Text className=\"text-2xl\">üõ†Ô∏è</Text>\r\n                            </View>\r\n                            <View className=\"flex-1\">\r\n                                <Text className=\"font-bold text-gray-800 text-lg\">{item.name}</Text>\r\n                                <View className=\"flex-row justify-between items-center mt-1\">\r\n                                    <Text className=\"text-blue-600 font-bold\">${item.price}</Text>\r\n                                    <Text className=\"text-gray-400 text-xs\">Stock: {item.stock}</Text>\r\n                                </View>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    )}\r\n                    ListEmptyComponent={\r\n                        <View className=\"py-20 items-center\">\r\n                            <Ionicons name=\"cube-outline\" size={60} color=\"#d1d5db\" />\r\n                            <Text className=\"text-gray-400 mt-4\">No supplies listed by this supplier.</Text>\r\n                        </View>\r\n                    }\r\n                />\r\n            </View>\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\supply-details.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchSupply'. Either include it or remove the dependency array.",
                "line": 19,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 19,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [fetchSupply, id]",
                        "fix": {
                            "range": [
                                813,
                                817
                            ],
                            "text": "[fetchSupply, id]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useLocalSearchParams, useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, Alert, ScrollView, Text, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nexport default function SupplyDetails() {\r\n    const { id } = useLocalSearchParams();\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [requesting, setRequesting] = useState(false);\r\n    const [supply, setSupply] = useState<any>(null);\r\n    const [requestQty, setRequestQty] = useState(1);\r\n\r\n    useEffect(() => {\r\n        fetchSupply();\r\n    }, [id]);\r\n\r\n    const fetchSupply = async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('supplies')\r\n                .select(`\r\n          *,\r\n          supplier:profiles(*)\r\n        `)\r\n                .eq('id', id)\r\n                .single();\r\n\r\n            if (error) throw error;\r\n            setSupply(data);\r\n        } catch (error: any) {\r\n            Alert.alert(\"Error\", error.message);\r\n            router.back();\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleRequest = async () => {\r\n        setRequesting(true);\r\n        try {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) {\r\n                Alert.alert(\"Login Required\", \"Please login to request supplies.\");\r\n                router.replace(\"/\");\r\n                return;\r\n            }\r\n\r\n            const { error } = await supabase\r\n                .from('supply_requests')\r\n                .insert({\r\n                    farmer_id: user.id,\r\n                    supply_id: supply.id,\r\n                    quantity: requestQty,\r\n                    status: 'pending'\r\n                });\r\n\r\n            if (error) throw error;\r\n\r\n            Alert.alert(\"Success!\", \"Your request has been sent to the supplier. They will contact you shortly.\", [\r\n                { text: \"OK\", onPress: () => router.replace(\"/\") }\r\n            ]);\r\n            router.back();\r\n\r\n        } catch (error: any) {\r\n            Alert.alert(\"Request Failed\", error.message);\r\n        } finally {\r\n            setRequesting(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <SafeAreaView className=\"flex-1 bg-white justify-center items-center\">\r\n                <ActivityIndicator size=\"large\" color=\"#1e40af\" />\r\n            </SafeAreaView>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-white\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            <ScrollView className=\"flex-1\" showsVerticalScrollIndicator={false}>\r\n                {/* Header/Image Area */}\r\n                <View className=\"h-48 bg-blue-50 justify-center items-center\">\r\n                    <TouchableOpacity\r\n                        onPress={() => router.back()}\r\n                        className=\"absolute top-4 left-4 bg-white p-2 rounded-full shadow-md z-10\"\r\n                    >\r\n                        <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                    </TouchableOpacity>\r\n                    <Text className=\"text-6xl text-blue-200\">üõ†Ô∏è</Text>\r\n                </View>\r\n\r\n                <View className=\"p-6\">\r\n                    <View className=\"flex-row justify-between items-start mb-2\">\r\n                        <View className=\"flex-1\">\r\n                            <Text className=\"text-sm font-bold text-blue-600 uppercase mb-1\">{supply.category}</Text>\r\n                            <Text className=\"text-2xl font-bold text-gray-900\">{supply.name}</Text>\r\n                        </View>\r\n                        <View>\r\n                            <Text className=\"text-2xl font-bold text-blue-700\">${supply.price}</Text>\r\n                            <Text className=\"text-gray-400 text-xs text-right\">per unit</Text>\r\n                        </View>\r\n                    </View>\r\n\r\n                    <TouchableOpacity\r\n                        onPress={() => router.push({ pathname: \"/supplier-profile\", params: { id: supply.supplier_id } })}\r\n                        className=\"flex-row items-center mb-6\"\r\n                    >\r\n                        <View className=\"w-8 h-8 bg-blue-100 rounded-full items-center justify-center mr-2\">\r\n                            <Text className=\"text-xs\">üè¢</Text>\r\n                        </View>\r\n                        <Text className=\"text-gray-600 font-medium\">{supply.supplier?.full_name} ‚Ä¢ {supply.supplier?.location}</Text>\r\n                        <Ionicons name=\"chevron-forward\" size={16} color=\"#9ca3af\" style={{ marginLeft: 4 }} />\r\n                    </TouchableOpacity>\r\n\r\n                    <View className=\"bg-gray-50 p-4 rounded-2xl mb-6\">\r\n                        <Text className=\"text-gray-800 leading-6\">{supply.description || \"No description provided for this item.\"}</Text>\r\n                    </View>\r\n\r\n                    {/* Request Quantity */}\r\n                    <View className=\"mb-8\">\r\n                        <Text className=\"text-lg font-bold text-gray-900 mb-4\">Request Quantity</Text>\r\n                        <View className=\"flex-row items-center bg-gray-50 rounded-2xl p-4 justify-between border border-gray-100\">\r\n                            <View className=\"flex-row items-center\">\r\n                                <TouchableOpacity\r\n                                    onPress={() => setRequestQty(Math.max(1, requestQty - 1))}\r\n                                    className=\"w-10 h-10 bg-white rounded-lg items-center justify-center shadow-sm border border-gray-100\"\r\n                                >\r\n                                    <Text className=\"text-xl font-bold\">-</Text>\r\n                                </TouchableOpacity>\r\n                                <Text className=\"mx-6 text-xl font-bold text-gray-800\">{requestQty}</Text>\r\n                                <TouchableOpacity\r\n                                    onPress={() => setRequestQty(requestQty + 1)}\r\n                                    className=\"w-10 h-10 bg-white rounded-lg items-center justify-center shadow-sm border border-gray-100\"\r\n                                >\r\n                                    <Text className=\"text-xl font-bold\">+</Text>\r\n                                </TouchableOpacity>\r\n                            </View>\r\n                            <Text className=\"text-gray-500 italic\">Avail: {supply.stock}</Text>\r\n                        </View>\r\n                    </View>\r\n\r\n                    <TouchableOpacity\r\n                        className={`w-full py-4 rounded-xl items-center shadow-md ${requesting ? 'bg-blue-300' : 'bg-blue-600'}`}\r\n                        onPress={handleRequest}\r\n                        disabled={requesting}\r\n                    >\r\n                        {requesting ? (\r\n                            <ActivityIndicator color=\"white\" />\r\n                        ) : (\r\n                            <Text className=\"text-white font-bold text-lg\">Send Request to Supplier</Text>\r\n                        )}\r\n                    </TouchableOpacity>\r\n                </View>\r\n            </ScrollView>\r\n        </SafeAreaView>\r\n    );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\app\\supply-market.tsx",
        "messages": [
            {
                "ruleId": "import/no-duplicates",
                "severity": 1,
                "message": "'E:\\agri\\node_modules\\react-native\\index.js' imported multiple times.",
                "line": 6,
                "column": 102,
                "nodeType": "Literal",
                "endLine": 6,
                "endColumn": 116
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'fetchSupplies'. Either include it or remove the dependency array.",
                "line": 26,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 26,
                "endColumn": 39,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [selectedCategory, searchQuery, fetchSupplies]",
                        "fix": {
                            "range": [
                                1110,
                                1141
                            ],
                            "text": "[selectedCategory, searchQuery, fetchSupplies]"
                        }
                    }
                ]
            },
            {
                "ruleId": "import/first",
                "severity": 1,
                "message": "Import in body of module; reorder to top.",
                "line": 156,
                "column": 1,
                "nodeType": "ImportDeclaration",
                "endLine": 156,
                "endColumn": 43,
                "fix": {
                    "range": [
                        0,
                        7364
                    ],
                    "text": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, FlatList, RefreshControl, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nimport { ScrollView } from 'react-native';\r\n\r\nconst SUPPLY_CATEGORIES = [\r\n    { id: 'seeds', name: 'Seeds', emoji: 'üå±' },\r\n    { id: 'tools', name: 'Tools', emoji: 'üöú' },\r\n    { id: 'fertilizer', name: 'Fertilizer', emoji: 'üß™' },\r\n    { id: 'feed', name: 'Livestock Feed', emoji: 'üåæ' },\r\n];\r\n\r\nexport default function SupplyMarket() {\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [refreshing, setRefreshing] = useState(false);\r\n    const [supplies, setSupplies] = useState<any[]>([]);\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        fetchSupplies();\r\n    }, [selectedCategory, searchQuery]);\r\n\r\n    const fetchSupplies = async () => {\r\n        try {\r\n            setLoading(true);\r\n            let query = supabase\r\n                .from('supplies')\r\n                .select(`\r\n          *,\r\n          supplier:profiles(full_name, location)\r\n        `)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (selectedCategory) {\r\n                query = query.eq('category', selectedCategory);\r\n            }\r\n\r\n            if (searchQuery) {\r\n                query = query.ilike('name', `%${searchQuery}%`);\r\n            }\r\n\r\n            const { data, error } = await query;\r\n            if (error) throw error;\r\n            setSupplies(data || []);\r\n        } catch (error) {\r\n            console.error(\"Error fetching supplies:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n            setRefreshing(false);\r\n        }\r\n    };\r\n\r\n    const onRefresh = () => {\r\n        setRefreshing(true);\r\n        fetchSupplies();\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-gray-50\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"px-6 py-4 bg-white border-b border-gray-100 flex-row items-center\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\r\n                    <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                </TouchableOpacity>\r\n                <View className=\"flex-1\">\r\n                    <Text className=\"text-xl font-bold text-blue-900\">Supply Market</Text>\r\n                    <Text className=\"text-gray-500 text-xs\">Essential items for your farm</Text>\r\n                </View>\r\n            </View>\r\n\r\n            {/* Search Bar */}\r\n            <View className=\"px-6 py-4 bg-white\">\r\n                <View className=\"flex-row items-center bg-gray-100 px-4 py-2 rounded-xl border border-gray-100\">\r\n                    <Ionicons name=\"search\" size={20} color=\"#6b7280\" />\r\n                    <TextInput\r\n                        className=\"flex-1 ml-2 text-gray-800\"\r\n                        placeholder=\"Search tools, seeds...\"\r\n                        value={searchQuery}\r\n                        onChangeText={setSearchQuery}\r\n                    />\r\n                </View>\r\n\r\n                {/* Categories */}\r\n                <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"mt-4\">\r\n                    <TouchableOpacity\r\n                        onPress={() => setSelectedCategory(null)}\r\n                        className={`px-4 py-2 rounded-full mr-2 ${!selectedCategory ? 'bg-blue-600' : 'bg-gray-100'}`}\r\n                    >\r\n                        <Text className={`font-medium ${!selectedCategory ? 'text-white' : 'text-gray-600'}`}>All</Text>\r\n                    </TouchableOpacity>\r\n                    {SUPPLY_CATEGORIES.map((cat) => (\r\n                        <TouchableOpacity\r\n                            key={cat.id}\r\n                            onPress={() => setSelectedCategory(cat.id)}\r\n                            className={`px-4 py-2 rounded-full mr-2 flex-row items-center ${selectedCategory === cat.id ? 'bg-blue-600' : 'bg-gray-100'}`}\r\n                        >\r\n                            <Text className=\"mr-1\">{cat.emoji}</Text>\r\n                            <Text className={`font-medium ${selectedCategory === cat.id ? 'text-white' : 'text-gray-600'}`}>{cat.name}</Text>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </ScrollView>\r\n            </View>\r\n\r\n            {loading && !refreshing ? (\r\n                <View className=\"flex-1 justify-center items-center\">\r\n                    <ActivityIndicator size=\"large\" color=\"#1e40af\" />\r\n                </View>\r\n            ) : (\r\n                <FlatList\r\n                    data={supplies}\r\n                    keyExtractor={(item) => item.id}\r\n                    contentContainerStyle={{ padding: 24 }}\r\n                    refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} />}\r\n                    renderItem={({ item }) => (\r\n                        <TouchableOpacity\r\n                            onPress={() => router.push({ pathname: \"/supply-details\", params: { id: item.id } })}\r\n                            className=\"bg-white p-4 rounded-2xl mb-4 shadow-sm border border-gray-100 flex-row\"\r\n                        >\r\n                            <View className=\"w-20 h-20 bg-blue-50 rounded-xl items-center justify-center mr-4\">\r\n                                <Text className=\"text-3xl\">üõ†Ô∏è</Text>\r\n                            </View>\r\n                            <View className=\"flex-1\">\r\n                                <Text className=\"text-sm font-bold text-blue-600 uppercase mb-1\">{item.category}</Text>\r\n                                <Text className=\"font-bold text-gray-800 text-lg mb-1\">{item.name}</Text>\r\n                                <Text className=\"text-gray-500 text-xs mb-2\" numberOfLines={1}>\r\n                                    {item.supplier?.full_name} ‚Ä¢ {item.supplier?.location}\r\n                                </Text>\r\n                                <View className=\"flex-row justify-between items-center\">\r\n                                    <Text className=\"text-blue-700 font-bold text-lg\">${item.price}</Text>\r\n                                    <View className=\"bg-blue-100 px-2 py-1 rounded\">\r\n                                        <Text className=\"text-blue-800 text-[10px] font-bold\">STOCK: {item.stock}</Text>\r\n                                    </View>\r\n                                </View>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    )}\r\n                    ListEmptyComponent={\r\n                        <View className=\"py-20 items-center\">\r\n                            <Ionicons name=\"cube-outline\" size={60} color=\"#d1d5db\" />\r\n                            <Text className=\"text-gray-400 mt-4\">No supplies found matching your criteria.</Text>\r\n                        </View>\r\n                    }\r\n                />\r\n            )}\r\n        </SafeAreaView>\r\n    );\r\n}"
                }
            },
            {
                "ruleId": "import/no-duplicates",
                "severity": 1,
                "message": "'E:\\agri\\node_modules\\react-native\\index.js' imported multiple times.",
                "line": 156,
                "column": 28,
                "nodeType": "Literal",
                "endLine": 156,
                "endColumn": 42
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 4,
        "fixableErrorCount": 0,
        "fixableWarningCount": 1,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ActivityIndicator, FlatList, RefreshControl, Text, TextInput, TouchableOpacity, View } from \"react-native\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\n\r\nconst SUPPLY_CATEGORIES = [\r\n    { id: 'seeds', name: 'Seeds', emoji: 'üå±' },\r\n    { id: 'tools', name: 'Tools', emoji: 'üöú' },\r\n    { id: 'fertilizer', name: 'Fertilizer', emoji: 'üß™' },\r\n    { id: 'feed', name: 'Livestock Feed', emoji: 'üåæ' },\r\n];\r\n\r\nexport default function SupplyMarket() {\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [refreshing, setRefreshing] = useState(false);\r\n    const [supplies, setSupplies] = useState<any[]>([]);\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        fetchSupplies();\r\n    }, [selectedCategory, searchQuery]);\r\n\r\n    const fetchSupplies = async () => {\r\n        try {\r\n            setLoading(true);\r\n            let query = supabase\r\n                .from('supplies')\r\n                .select(`\r\n          *,\r\n          supplier:profiles(full_name, location)\r\n        `)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (selectedCategory) {\r\n                query = query.eq('category', selectedCategory);\r\n            }\r\n\r\n            if (searchQuery) {\r\n                query = query.ilike('name', `%${searchQuery}%`);\r\n            }\r\n\r\n            const { data, error } = await query;\r\n            if (error) throw error;\r\n            setSupplies(data || []);\r\n        } catch (error) {\r\n            console.error(\"Error fetching supplies:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n            setRefreshing(false);\r\n        }\r\n    };\r\n\r\n    const onRefresh = () => {\r\n        setRefreshing(true);\r\n        fetchSupplies();\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView className=\"flex-1 bg-gray-50\">\r\n            <StatusBar style=\"dark\" />\r\n\r\n            {/* Header */}\r\n            <View className=\"px-6 py-4 bg-white border-b border-gray-100 flex-row items-center\">\r\n                <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\r\n                    <Ionicons name=\"arrow-back\" size={24} color=\"black\" />\r\n                </TouchableOpacity>\r\n                <View className=\"flex-1\">\r\n                    <Text className=\"text-xl font-bold text-blue-900\">Supply Market</Text>\r\n                    <Text className=\"text-gray-500 text-xs\">Essential items for your farm</Text>\r\n                </View>\r\n            </View>\r\n\r\n            {/* Search Bar */}\r\n            <View className=\"px-6 py-4 bg-white\">\r\n                <View className=\"flex-row items-center bg-gray-100 px-4 py-2 rounded-xl border border-gray-100\">\r\n                    <Ionicons name=\"search\" size={20} color=\"#6b7280\" />\r\n                    <TextInput\r\n                        className=\"flex-1 ml-2 text-gray-800\"\r\n                        placeholder=\"Search tools, seeds...\"\r\n                        value={searchQuery}\r\n                        onChangeText={setSearchQuery}\r\n                    />\r\n                </View>\r\n\r\n                {/* Categories */}\r\n                <ScrollView horizontal showsHorizontalScrollIndicator={false} className=\"mt-4\">\r\n                    <TouchableOpacity\r\n                        onPress={() => setSelectedCategory(null)}\r\n                        className={`px-4 py-2 rounded-full mr-2 ${!selectedCategory ? 'bg-blue-600' : 'bg-gray-100'}`}\r\n                    >\r\n                        <Text className={`font-medium ${!selectedCategory ? 'text-white' : 'text-gray-600'}`}>All</Text>\r\n                    </TouchableOpacity>\r\n                    {SUPPLY_CATEGORIES.map((cat) => (\r\n                        <TouchableOpacity\r\n                            key={cat.id}\r\n                            onPress={() => setSelectedCategory(cat.id)}\r\n                            className={`px-4 py-2 rounded-full mr-2 flex-row items-center ${selectedCategory === cat.id ? 'bg-blue-600' : 'bg-gray-100'}`}\r\n                        >\r\n                            <Text className=\"mr-1\">{cat.emoji}</Text>\r\n                            <Text className={`font-medium ${selectedCategory === cat.id ? 'text-white' : 'text-gray-600'}`}>{cat.name}</Text>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </ScrollView>\r\n            </View>\r\n\r\n            {loading && !refreshing ? (\r\n                <View className=\"flex-1 justify-center items-center\">\r\n                    <ActivityIndicator size=\"large\" color=\"#1e40af\" />\r\n                </View>\r\n            ) : (\r\n                <FlatList\r\n                    data={supplies}\r\n                    keyExtractor={(item) => item.id}\r\n                    contentContainerStyle={{ padding: 24 }}\r\n                    refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} />}\r\n                    renderItem={({ item }) => (\r\n                        <TouchableOpacity\r\n                            onPress={() => router.push({ pathname: \"/supply-details\", params: { id: item.id } })}\r\n                            className=\"bg-white p-4 rounded-2xl mb-4 shadow-sm border border-gray-100 flex-row\"\r\n                        >\r\n                            <View className=\"w-20 h-20 bg-blue-50 rounded-xl items-center justify-center mr-4\">\r\n                                <Text className=\"text-3xl\">üõ†Ô∏è</Text>\r\n                            </View>\r\n                            <View className=\"flex-1\">\r\n                                <Text className=\"text-sm font-bold text-blue-600 uppercase mb-1\">{item.category}</Text>\r\n                                <Text className=\"font-bold text-gray-800 text-lg mb-1\">{item.name}</Text>\r\n                                <Text className=\"text-gray-500 text-xs mb-2\" numberOfLines={1}>\r\n                                    {item.supplier?.full_name} ‚Ä¢ {item.supplier?.location}\r\n                                </Text>\r\n                                <View className=\"flex-row justify-between items-center\">\r\n                                    <Text className=\"text-blue-700 font-bold text-lg\">${item.price}</Text>\r\n                                    <View className=\"bg-blue-100 px-2 py-1 rounded\">\r\n                                        <Text className=\"text-blue-800 text-[10px] font-bold\">STOCK: {item.stock}</Text>\r\n                                    </View>\r\n                                </View>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    )}\r\n                    ListEmptyComponent={\r\n                        <View className=\"py-20 items-center\">\r\n                            <Ionicons name=\"cube-outline\" size={60} color=\"#d1d5db\" />\r\n                            <Text className=\"text-gray-400 mt-4\">No supplies found matching your criteria.</Text>\r\n                        </View>\r\n                    }\r\n                />\r\n            )}\r\n        </SafeAreaView>\r\n    );\r\n}\r\n\r\nimport { ScrollView } from 'react-native'; // Fixed missing import for Categories\r\n\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\babel.config.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\components\\homes\\BuyerHome.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'topFarms' is assigned a value but never used.",
                "line": 27,
                "column": 10,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 27,
                "endColumn": 18
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useFocusEffect } from '@react-navigation/native';\r\nimport { useRouter } from 'expo-router';\r\nimport { StatusBar } from 'expo-status-bar';\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport {\r\n  RefreshControl,\r\n  ScrollView,\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View\r\n} from 'react-native';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\n\r\nexport default function BuyerHome() {\r\n  const router = useRouter();\r\n\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [user, setUser] = useState<any>(null);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n  const [products, setProducts] = useState<any[]>([]);\r\n  const [topFarms, setTopFarms] = useState<any[]>([]);\r\n  const [cartCount, setCartCount] = useState(0);\r\n\r\n  const categories = useMemo(\r\n    () => [\r\n      { name: 'Fruits', slug: 'fruits', icon: 'üçé' },\r\n      { name: 'Vegetables', slug: 'vegetables', icon: 'ü•¶' },\r\n      { name: 'Dairy', slug: 'dairy', icon: 'ü•õ' },\r\n      { name: 'Grains', slug: 'grains', icon: 'üåæ' },\r\n      { name: 'Meat', slug: 'meat', icon: 'ü•©' },\r\n    ],\r\n    []\r\n  );\r\n\r\n  /* ===================== USER ===================== */\r\n  const getUser = useCallback(async () => {\r\n    const { data } = await supabase.auth.getUser();\r\n    if (!data?.user) return setUser(null);\r\n\r\n    const { data: profile } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('id', data.user.id)\r\n      .single();\r\n\r\n    setUser({ ...data.user, ...profile });\r\n  }, []);\r\n\r\n  /* ===================== CART ===================== */\r\n  const updateCartCount = useCallback(async () => {\r\n    const cartStr = await AsyncStorage.getItem('cart');\r\n    if (!cartStr) return setCartCount(0);\r\n\r\n    const cart = JSON.parse(cartStr);\r\n    const total = cart.reduce(\r\n      (sum: number, item: any) => sum + (item.quantity || 0),\r\n      0\r\n    );\r\n    setCartCount(total);\r\n  }, []);\r\n\r\n  const addToCart = useCallback(\r\n    async (product: any) => {\r\n      const cartStr = await AsyncStorage.getItem('cart');\r\n      const cart = cartStr ? JSON.parse(cartStr) : [];\r\n\r\n      const index = cart.findIndex((i: any) => i.id === product.id);\r\n\r\n      if (index >= 0) cart[index].quantity += 1;\r\n      else cart.push({ ...product, quantity: 1 });\r\n\r\n      await AsyncStorage.setItem('cart', JSON.stringify(cart));\r\n      updateCartCount();\r\n    },\r\n    [updateCartCount]\r\n  );\r\n\r\n  /* ===================== DATA ===================== */\r\n  const fetchTopFarms = useCallback(async () => {\r\n    const { data } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('role', 'farmer')\r\n      .limit(5);\r\n\r\n    setTopFarms(data || []);\r\n  }, []);\r\n\r\n  const fetchProducts = useCallback(async () => {\r\n    let query = supabase.from('products').select('*').gt('stock', 0);\r\n\r\n    if (selectedCategory) {\r\n      query = query.eq('category', selectedCategory);\r\n    }\r\n\r\n    const { data } = await query;\r\n    setProducts(data || []);\r\n  }, [selectedCategory]);\r\n\r\n  /* ===================== EFFECTS ===================== */\r\n  useEffect(() => {\r\n    getUser();\r\n    fetchTopFarms();\r\n    fetchProducts();\r\n  }, [getUser, fetchTopFarms, fetchProducts]);\r\n\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      updateCartCount();\r\n    }, [updateCartCount])\r\n  );\r\n\r\n  const onRefresh = async () => {\r\n    setRefreshing(true);\r\n    await Promise.all([fetchProducts(), fetchTopFarms(), getUser(), updateCartCount()]);\r\n    setRefreshing(false);\r\n  };\r\n\r\n  /* ===================== LOGOUT ===================== */\r\n  const handleLogout = async () => {\r\n    try {\r\n      console.log(\"[BuyerHome] Logout clicked. Setting flag...\");\r\n      await AsyncStorage.setItem('logging_out', 'true');\r\n      console.log(\"[BuyerHome] Flag set. Redirecting...\");\r\n      (router as any).replace(\"/\"); // Redirection imm√©diate\r\n\r\n      // Cleanup de fond\r\n      await supabase.auth.signOut();\r\n      await AsyncStorage.multiRemove(['user_session', 'cart']);\r\n      console.log(\"[BuyerHome] Content cleared.\");\r\n    } catch (error) {\r\n      console.error(\"[BuyerHome] Logout error:\", error);\r\n      (router as any).replace(\"/\");\r\n    }\r\n  };\r\n\r\n\r\n\r\n  /* ===================== FILTER ===================== */\r\n  const filteredProducts = useMemo(() => {\r\n    if (!searchQuery) return products;\r\n    return products.filter((p) =>\r\n      p.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n  }, [products, searchQuery]);\r\n\r\n  /* ===================== UI ===================== */\r\n  return (\r\n    <View className=\"flex-1 bg-white\">\r\n      <StatusBar style=\"dark\" />\r\n\r\n      <SafeAreaView className=\"bg-green-50\">\r\n        <View className=\"px-6 py-4 flex-row justify-between items-center\">\r\n          <View>\r\n            <Text className=\"text-gray-600 text-sm\">Good morning</Text>\r\n            <Text className=\"text-2xl font-bold text-green-800\">\r\n              {user?.full_name?.split(' ')[0] || 'User'}\r\n            </Text>\r\n          </View>\r\n\r\n          <TouchableOpacity onPress={handleLogout}>\r\n            <Ionicons name=\"log-out-outline\" size={26} color=\"#dc2626\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View className=\"px-6 pb-4\">\r\n          <View className=\"bg-white rounded-xl px-4 py-2 flex-row items-center\">\r\n            <Ionicons name=\"search\" size={20} color=\"#9ca3af\" />\r\n            <TextInput\r\n              placeholder=\"Search products...\"\r\n              className=\"flex-1 ml-2\"\r\n              value={searchQuery}\r\n              onChangeText={setSearchQuery}\r\n            />\r\n            <Text className=\"ml-2 text-green-600 font-bold\">\r\n              üõí {cartCount}\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      </SafeAreaView>\r\n\r\n      <ScrollView\r\n        className=\"px-6\"\r\n        refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} />}\r\n      >\r\n        <Text className=\"text-lg font-bold my-4\">Categories</Text>\r\n\r\n        <ScrollView horizontal showsHorizontalScrollIndicator={false}>\r\n          {categories.map((cat) => (\r\n            <TouchableOpacity\r\n              key={cat.slug}\r\n              onPress={() =>\r\n                setSelectedCategory((prev) => (prev === cat.slug ? null : cat.slug))\r\n              }\r\n              className={`mr-3 px-5 py-3 rounded-xl ${selectedCategory === cat.slug ? 'bg-green-600' : 'bg-green-100'\r\n                }`}\r\n            >\r\n              <Text\r\n                className={`font-bold ${selectedCategory === cat.slug ? 'text-white' : 'text-green-700'\r\n                  }`}\r\n              >\r\n                {cat.icon} {cat.name}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n\r\n        <Text className=\"text-lg font-bold my-4\">Products</Text>\r\n\r\n        <View className=\"flex-row flex-wrap justify-between\">\r\n          {filteredProducts.map((p) => (\r\n            <View\r\n              key={p.id}\r\n              className=\"w-[48%] bg-white rounded-xl p-3 mb-4 border\"\r\n            >\r\n              <Text className=\"text-3xl text-center mb-2\">üì¶</Text>\r\n              <Text className=\"font-bold\" numberOfLines={1}>\r\n                {p.name}\r\n              </Text>\r\n              <View className=\"flex-row justify-between items-center mt-2\">\r\n                <Text className=\"text-green-600 font-bold\">${p.price}</Text>\r\n                <TouchableOpacity onPress={() => addToCart(p)}>\r\n                  <Ionicons name=\"add-circle\" size={26} color=\"#16a34a\" />\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          ))}\r\n        </View>\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\components\\homes\\FarmerHome.tsx",
        "messages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useCallback has a missing dependency: 'loadFarmerData'. Either include it or remove the dependency array.",
                "line": 188,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 188,
                "endColumn": 12,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [loadFarmerData]",
                        "fix": {
                            "range": [
                                5931,
                                5937
                            ],
                            "text": "[loadFarmerData]"
                        }
                    }
                ]
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'error' is defined but never used.",
                "line": 197,
                "column": 14,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 197,
                "endColumn": 19
            }
        ],
        "suppressedMessages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'initializeUser'. Either include it or remove the dependency array.",
                "line": 68,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 68,
                "endColumn": 8,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [initializeUser]",
                        "fix": {
                            "range": [
                                1742,
                                1744
                            ],
                            "text": "[initializeUser]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'loadFarmerData'. Either include it or remove the dependency array.",
                "line": 75,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 75,
                "endColumn": 16,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [loadFarmerData, user?.id]",
                        "fix": {
                            "range": [
                                1890,
                                1900
                            ],
                            "text": "[loadFarmerData, user?.id]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport {\r\n  ActivityIndicator,\r\n  RefreshControl,\r\n  ScrollView,\r\n  Text,\r\n  TouchableOpacity,\r\n  View,\r\n} from \"react-native\";\r\n\r\n// -------------------- Types --------------------\r\ninterface User {\r\n  id: string;\r\n  full_name: string;\r\n  email?: string;\r\n  farm_name?: string;\r\n  phone?: string;\r\n  avatar_url?: string;\r\n}\r\n\r\ninterface FarmerStats {\r\n  productsListed: number;\r\n  ordersToday: number;\r\n  totalRevenue: number;\r\n  farmRating: number;\r\n  pendingOrders: number;\r\n  lowStockItems: number;\r\n}\r\n\r\ntype OrderStatus = 'pending' | 'shipped' | 'delivered' | 'cancelled';\r\n\r\ninterface Order {\r\n  id: string;\r\n  product: string;\r\n  buyer: string;\r\n  status: OrderStatus;\r\n  amount: string;\r\n  date: string;\r\n  quantity?: number;\r\n}\r\n\r\n// -------------------- Component --------------------\r\nexport default function FarmerHome() {\r\n  const router = useRouter();\r\n\r\n  // State\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [farmerStats, setFarmerStats] = useState<FarmerStats>({\r\n    productsListed: 0,\r\n    ordersToday: 0,\r\n    totalRevenue: 0,\r\n    farmRating: 0,\r\n    pendingOrders: 0,\r\n    lowStockItems: 0,\r\n  });\r\n  const [recentOrders, setRecentOrders] = useState<Order[]>([]);\r\n\r\n  useEffect(() => {\r\n    initializeUser();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      loadFarmerData();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user?.id]);\r\n\r\n  const initializeUser = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const sessionData = await AsyncStorage.getItem('user_session');\r\n      let userData = sessionData ? JSON.parse(sessionData) : null;\r\n\r\n      if (!userData) {\r\n        const { data: { user: authUser } } = await supabase.auth.getUser();\r\n        if (authUser) {\r\n          userData = { id: authUser.id, email: authUser.email };\r\n        }\r\n      }\r\n\r\n      if (!userData) throw new Error('No session found');\r\n      setUser(userData);\r\n\r\n      const { data: profile } = await supabase.from('profiles').select('*').eq('id', userData.id).maybeSingle();\r\n      if (profile) setUser(prev => ({ ...prev, ...profile } as User));\r\n\r\n    } catch (error) {\r\n      console.log(\"[FarmerHome] Auth error:\", error);\r\n      router.replace(\"/\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadFarmerData = async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const today = new Date().toISOString().split('T')[0];\r\n      const { data: products } = await supabase.from('products').select('id, stock').eq('farmer_id', user.id);\r\n\r\n      const { data: salesItems } = await supabase\r\n        .from('order_items')\r\n        .select(`\r\n          quantity, \r\n          price, \r\n          order:orders!inner(id, status, created_at), \r\n          product:products!inner(id, farmer_id)\r\n        `)\r\n        .eq('product.farmer_id', user.id);\r\n\r\n      const allItems: any[] = salesItems || [];\r\n      const getOrder = (item: any) => Array.isArray(item.order) ? item.order[0] : item.order;\r\n\r\n      const ordersToday = allItems.filter(i => {\r\n        const order = getOrder(i);\r\n        return order?.created_at && order.created_at >= today;\r\n      }).length;\r\n\r\n      const pendingOrders = allItems.filter(i => {\r\n        const order = getOrder(i);\r\n        return order?.status === 'pending';\r\n      }).length;\r\n\r\n      const totalRevenue = allItems\r\n        .filter(i => getOrder(i)?.status === 'delivered')\r\n        .reduce((sum, i) => sum + (i.quantity * (i.price || 0)), 0);\r\n\r\n      const { data: reviewData } = await supabase.from('reviews').select('rating, product:products!inner(farmer_id)').eq('product.farmer_id', user.id);\r\n      const avgRating = reviewData && reviewData.length ? reviewData.reduce((a, b) => a + (b.rating || 0), 0) / reviewData.length : 0;\r\n\r\n      setFarmerStats({\r\n        productsListed: products?.length || 0,\r\n        ordersToday,\r\n        totalRevenue: Math.round(totalRevenue * 100) / 100,\r\n        farmRating: Math.round(avgRating * 10) / 10,\r\n        pendingOrders,\r\n        lowStockItems: products?.filter((p: any) => (p.stock || 0) < 10).length || 0\r\n      });\r\n\r\n      // Orders\r\n      const { data: orderData } = await supabase.from('order_items')\r\n        .select(`\r\n          id, \r\n          quantity, \r\n          price, \r\n          order:orders!inner(id, status, created_at, buyer_id), \r\n          product:products!inner(name, farmer_id)\r\n        `)\r\n        .eq('product.farmer_id', user.id)\r\n        .order('created_at', { foreignTable: 'order', ascending: false })\r\n        .limit(5);\r\n\r\n      const orders: Order[] = (orderData || []).map((item: any) => {\r\n        const order = Array.isArray(item.order) ? item.order[0] : item.order;\r\n        const product = Array.isArray(item.product) ? item.product[0] : item.product;\r\n\r\n        return {\r\n          id: order?.id || item.id,\r\n          product: product?.name || 'Unknown Product',\r\n          buyer: 'Customer',\r\n          status: order?.status || 'pending',\r\n          amount: (item.quantity * (item.price || 0)).toFixed(2),\r\n          date: order?.created_at ? new Date(order.created_at).toLocaleDateString() : 'N/A',\r\n          quantity: item.quantity\r\n        };\r\n      });\r\n      setRecentOrders(orders);\r\n\r\n    } catch (e) {\r\n      console.error('[FarmerHome] Data load error:', e);\r\n    }\r\n  };\r\n\r\n  const onRefresh = useCallback(async () => {\r\n    setRefreshing(true);\r\n    await loadFarmerData();\r\n    setRefreshing(false);\r\n  }, [user]);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      console.log(\"[FarmerHome] Logout clicked. Setting flag...\");\r\n      await AsyncStorage.setItem('logging_out', 'true');\r\n      (router as any).replace(\"/\");\r\n      await supabase.auth.signOut();\r\n      await AsyncStorage.removeItem('user_session');\r\n    } catch (error) {\r\n      (router as any).replace(\"/\");\r\n    }\r\n  };\r\n\r\n  if (loading) return <View className=\"flex-1 bg-white justify-center items-center\"><ActivityIndicator size=\"large\" color=\"#16a34a\" /></View>;\r\n\r\n  return (\r\n    <View className=\"flex-1 bg-[#f8fafc]\">\r\n      <StatusBar style=\"light\" />\r\n\r\n      {/* Simple Header */}\r\n      <View className=\"bg-green-600 pt-14 pb-6 px-6 shadow-md\">\r\n        <View className=\"flex-row justify-between items-center mb-4\">\r\n          <View>\r\n            <Text className=\"text-green-100 text-xs font-bold uppercase\">Farmer Portal</Text>\r\n            <Text className=\"text-2xl font-bold text-white\">\r\n              Hello, {user?.full_name?.split(' ')[0] || 'Farmer'}!\r\n            </Text>\r\n          </View>\r\n          <TouchableOpacity\r\n            onPress={handleLogout}\r\n            className=\"bg-green-700 p-2 rounded-lg\"\r\n          >\r\n            <Ionicons name=\"log-out-outline\" size={24} color=\"white\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View className=\"bg-green-700/30 p-4 rounded-xl\">\r\n          <Text className=\"text-green-50 text-xs font-bold uppercase mb-1\">Total Revenue</Text>\r\n          <Text className=\"text-white text-3xl font-bold\">${farmerStats.totalRevenue.toLocaleString()}</Text>\r\n        </View>\r\n      </View>\r\n\r\n      <ScrollView\r\n        className=\"flex-1 -mt-8\"\r\n        contentContainerStyle={{ paddingHorizontal: 20, paddingBottom: 40 }}\r\n        showsVerticalScrollIndicator={false}\r\n        refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} tintColor=\"#16a34a\" />}\r\n      >\r\n        {/* Secondary Stats Row */}\r\n        <View className=\"flex-row justify-between mt-6 mb-6\">\r\n          <View className=\"w-[48%] bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\r\n            <Text className=\"text-gray-400 text-xs font-bold uppercase mb-1\">Pending Orders</Text>\r\n            <Text className=\"text-xl font-bold text-gray-800\">{farmerStats.pendingOrders}</Text>\r\n          </View>\r\n          <View className=\"w-[48%] bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\r\n            <Text className=\"text-gray-400 text-xs font-bold uppercase mb-1\">Active Products</Text>\r\n            <Text className=\"text-xl font-bold text-gray-800\">{farmerStats.productsListed}</Text>\r\n          </View>\r\n        </View>\r\n\r\n        {/* Quick Actions */}\r\n        <Text className=\"text-lg font-bold text-gray-800 mb-4\">Quick Actions</Text>\r\n        <View className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-8 flex-row justify-between\">\r\n          <TouchableOpacity\r\n            onPress={() => router.push(\"/add-product\")}\r\n            className=\"items-center\"\r\n          >\r\n            <View className=\"bg-green-100 p-3 rounded-full mb-2\">\r\n              <Ionicons name=\"add\" size={24} color=\"#16a34a\" />\r\n            </View>\r\n            <Text className=\"text-xs font-bold text-gray-700\">Add Product</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity\r\n            onPress={() => router.push(\"/my-products\")}\r\n            className=\"items-center\"\r\n          >\r\n            <View className=\"bg-blue-100 p-3 rounded-full mb-2\">\r\n              <Ionicons name=\"list\" size={24} color=\"#2563eb\" />\r\n            </View>\r\n            <Text className=\"text-xs font-bold text-gray-700\">Inventory</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity\r\n            onPress={() => router.push(\"/supply-market\")}\r\n            className=\"items-center\"\r\n          >\r\n            <View className=\"bg-orange-100 p-3 rounded-full mb-2\">\r\n              <Ionicons name=\"basket\" size={24} color=\"#ea580c\" />\r\n            </View>\r\n            <Text className=\"text-xs font-bold text-gray-700\">Supplies</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        {/* Recent Orders Section */}\r\n        <View className=\"flex-row justify-between items-center mb-4\">\r\n          <Text className=\"text-lg font-bold text-gray-800\">Recent Sales</Text>\r\n          <TouchableOpacity onPress={() => router.push(\"/(tabs)/orders\" as any)}>\r\n            <Text className=\"text-green-600 font-bold\">See all</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        {recentOrders.length === 0 ? (\r\n          <View className=\"bg-white p-8 rounded-xl border border-gray-200 items-center\">\r\n            <Text className=\"text-gray-400\">No orders yet.</Text>\r\n          </View>\r\n        ) : (\r\n          recentOrders.map(order => (\r\n            <View\r\n              key={order.id}\r\n              className=\"bg-white p-4 rounded-xl border border-gray-100 mb-3 flex-row items-center shadow-sm\"\r\n            >\r\n              <View className=\"flex-1\">\r\n                <Text className=\"font-bold text-gray-800\">{order.product}</Text>\r\n                <Text className=\"text-gray-500 text-xs\">{order.date}</Text>\r\n              </View>\r\n              <View className=\"items-end\">\r\n                <Text className=\"font-bold text-green-700\">${order.amount}</Text>\r\n                <Text className={`text-[10px] font-bold uppercase ${order.status === 'pending' ? 'text-yellow-600' : 'text-green-600'}`}>\r\n                  {order.status}\r\n                </Text>\r\n              </View>\r\n            </View>\r\n          ))\r\n        )}\r\n      </ScrollView>\r\n\r\n      {/* Floating Action Button */}\r\n      <TouchableOpacity\r\n        onPress={() => router.push(\"/add-product\")}\r\n        className=\"absolute bottom-6 right-6 bg-green-600 w-14 h-14 rounded-full items-center justify-center shadow-lg\"\r\n      >\r\n        <Ionicons name=\"add\" size={30} color=\"white\" />\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\components\\homes\\SupplierHome.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'error' is defined but never used.",
                "line": 52,
                "column": 14,
                "nodeType": null,
                "messageId": "unusedVar",
                "endLine": 52,
                "endColumn": 19
            }
        ],
        "suppressedMessages": [
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'loadData'. Either include it or remove the dependency array.",
                "line": 25,
                "column": 6,
                "nodeType": "ArrayExpression",
                "endLine": 25,
                "endColumn": 8,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [loadData]",
                        "fix": {
                            "range": [
                                828,
                                830
                            ],
                            "text": "[loadData]"
                        }
                    }
                ],
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { supabase } from '@/lib/supabaseClient';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useRouter } from \"expo-router\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport { useEffect, useState } from \"react\";\r\nimport {\r\n  RefreshControl,\r\n  ScrollView,\r\n  Text,\r\n  TouchableOpacity,\r\n  View,\r\n} from \"react-native\";\r\n\r\nexport default function SupplierHome() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<any>(null);\r\n  const [stats, setStats] = useState({ totalSales: 0, activeSupplies: 0 });\r\n  const [supplies, setSupplies] = useState<any[]>([]);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const loadData = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) { router.replace(\"/\"); return; }\r\n\r\n    const { data } = await supabase.from('profiles').select('*').eq('id', user.id).single();\r\n    setUser({ ...user, ...data });\r\n\r\n    const { data: suppliesData } = await supabase.from('supplies').select('*').eq('supplier_id', user.id);\r\n    setSupplies(suppliesData || []);\r\n    setStats(prev => ({ ...prev, activeSupplies: suppliesData?.length || 0 }));\r\n  };\r\n\r\n  const onRefresh = async () => {\r\n    setRefreshing(true);\r\n    await loadData();\r\n    setRefreshing(false);\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      console.log(\"[SupplierHome] Logout clicked. Setting flag...\");\r\n      await AsyncStorage.setItem('logging_out', 'true');\r\n      (router as any).replace(\"/\");\r\n      await supabase.auth.signOut();\r\n      await AsyncStorage.removeItem('user_session');\r\n    } catch (error) {\r\n      (router as any).replace(\"/\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View className=\"flex-1 bg-white\">\r\n      <StatusBar style=\"light\" />\r\n\r\n      {/* Header */}\r\n      <View className=\"bg-blue-600 pt-14 pb-8 px-6 shadow-md\">\r\n        <View className=\"flex-row justify-between items-center mb-6\">\r\n          <View>\r\n            <Text className=\"text-blue-100 text-xs font-bold uppercase\">Supplier Portal</Text>\r\n            <Text className=\"text-2xl font-bold text-white tracking-tight\">\r\n              {user?.full_name?.split(' ')[0] || 'Supplier'}!\r\n            </Text>\r\n          </View>\r\n          <TouchableOpacity\r\n            onPress={handleLogout}\r\n            className=\"bg-blue-700 p-2 rounded-lg\"\r\n          >\r\n            <Ionicons name=\"log-out-outline\" size={24} color=\"white\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View className=\"bg-blue-700/30 p-4 rounded-xl\">\r\n          <Text className=\"text-blue-50 text-xs font-bold uppercase mb-1\">Inventory Value</Text>\r\n          <Text className=\"text-white text-3xl font-bold\">$12,450</Text>\r\n        </View>\r\n      </View>\r\n\r\n      <ScrollView\r\n        className=\"flex-1 -mt-6\"\r\n        contentContainerStyle={{ paddingHorizontal: 24, paddingBottom: 100 }}\r\n        showsVerticalScrollIndicator={false}\r\n        refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} tintColor=\"#3b82f6\" />}\r\n      >\r\n        {/* Stats and Actions */}\r\n        <View className=\"flex-row justify-between mt-6 mb-8\">\r\n          <View className=\"w-[48%] bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\r\n            <View className=\"flex-row justify-between items-center mb-2\">\r\n              <Text className=\"text-gray-400 text-xs font-bold uppercase\">Stock</Text>\r\n              <Ionicons name=\"cube\" size={16} color=\"#2563eb\" />\r\n            </View>\r\n            <Text className=\"text-2xl font-bold text-gray-800\">{stats.activeSupplies}</Text>\r\n          </View>\r\n          <TouchableOpacity\r\n            onPress={() => router.push(\"/add-supply\" as any)}\r\n            className=\"w-[48%] bg-blue-600 p-4 rounded-xl shadow-md items-center justify-center\"\r\n          >\r\n            <Text className=\"text-white font-bold\">Add Supply</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <Text className=\"text-lg font-bold text-gray-800 mb-4\">My Supplies</Text>\r\n        {supplies.map((item) => (\r\n          <TouchableOpacity\r\n            key={item.id}\r\n            onPress={() => router.push({ pathname: \"/add-supply\", params: { id: item.id } })}\r\n            className=\"bg-white p-4 rounded-xl border border-gray-100 mb-3 flex-row justify-between items-center shadow-sm\"\r\n          >\r\n            <View className=\"flex-row items-center flex-1\">\r\n              <View className=\"bg-blue-50 w-10 h-10 rounded-lg items-center justify-center mr-4\">\r\n                <Text className=\"text-xl\">üì¶</Text>\r\n              </View>\r\n              <View className=\"flex-1\">\r\n                <Text className=\"font-bold text-gray-800\" numberOfLines={1}>{item.name}</Text>\r\n                <Text className=\"text-gray-500 text-xs\">${item.price} ‚Ä¢ Stock: {item.stock}</Text>\r\n              </View>\r\n            </View>\r\n            <Ionicons name=\"chevron-forward\" size={18} color=\"#9ca3af\" />\r\n          </TouchableOpacity>\r\n        ))}\r\n        {supplies.length === 0 && (\r\n          <View className=\"py-10 items-center bg-gray-50 rounded-[40px] border border-dashed border-gray-300\">\r\n            <Ionicons name=\"file-tray-outline\" size={40} color=\"#9ca3af\" />\r\n            <Text className=\"text-gray-400 mt-2 font-medium\">Clear of stock for now.</Text>\r\n          </View>\r\n        )}\r\n      </ScrollView>\r\n\r\n    </View>\r\n  );\r\n}\r\n",
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_constraints.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_final.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_find_success.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_inspect.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_orders.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_orders_exhaustive.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_profile.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_profile_v2.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_schema.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_simple.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\debug_tables.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\eslint.config.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\expo-env.d.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\hooks\\useSupaAuth.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\lib\\auth.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\lib\\products.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\lib\\supabaseClient.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\metro.config.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\nativewind-env.d.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\tailwind.config.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\test_status.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    },
    {
        "filePath": "E:\\agri\\types\\database.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": []
    }
]